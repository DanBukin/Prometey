"""
–ú–æ–¥—É–ª—å —Å –æ—Å–Ω–æ–≤–Ω—ã–º–∏ –≤—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω—ã–º–∏ —Ñ—É–Ω–∫—Ü–∏—è–º–∏ –¥–ª—è –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏—è –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ —Ä–µ–≥–µ–Ω–µ—Ä–∞—Ç–∏–≤–Ω–æ–≥–æ –æ—Ö–ª–∞–∂–¥–µ–Ω–∏—è –ñ–†–î.

–ó–¥–µ—Å—å —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã:
- –†–∞—Å—á—ë—Ç —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä –æ—Ö–ª–∞–¥–∏—Ç–µ–ª—è –≤–¥–æ–ª—å –∫–∞–Ω–∞–ª–∞ (`find_temp` –∏ –µ–≥–æ –≤–∞—Ä–∏–∞—Ü–∏–∏),
- –†–∞—Å—á—ë—Ç —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä —Å—Ç–µ–Ω–æ–∫ (`find_temp_st_g`),
- –†–∞—Å—á—ë—Ç —Ç–µ–ø–ª–æ–≤—ã—Ö –ø–æ—Ç–æ–∫–æ–≤ (`find_q_kon`, `find_q_l`, `find_q_sum`),
- –†–∞—Å—á—ë—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –ø–æ—Ç–æ–∫–∞ –≥–∞–∑–∞ (Œª, Œ≤, –∏ —Ç.–¥.),
- –ò–Ω—Ç–µ—Ä–ø–æ–ª—è—Ü–∏—è —Ç–µ—Ä–º–æ–¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏—Ö —Å–≤–æ–π—Å—Ç–≤ –æ—Ö–ª–∞–¥–∏—Ç–µ–ª–µ–π,
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç —Å–æ–ø–ª–∞ –∏ –¥—Ä—É–≥–∏—Ö –≥–µ–æ–º–µ—Ç—Ä–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö.

–ú–æ–¥—É–ª—å —è–≤–ª—è–µ—Ç—Å—è —è–¥—Ä–æ–º –∏–Ω–∂–µ–Ω–µ—Ä–Ω—ã—Ö —Ä–∞—Å—á—ë—Ç–æ–≤ –∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥—Ä—É–≥–∏–º–∏ –º–æ–¥—É–ª—è–º–∏ –ø—Ä–æ–µ–∫—Ç–∞.
"""
import pandas as pd
from openpyxl import load_workbook
import math
import numpy as np
import os
from scipy.optimize import root_scalar
from scipy.interpolate import griddata, RBFInterpolator, interp1d
from scipy.spatial import Delaunay
def find_target_row(df, target_string):
    """
        –ü–æ–∏—Å–∫ –∏–Ω–¥–µ–∫—Å–∞ —Å—Ç—Ä–æ–∫–∏ –≤ DataFrame, —Å–æ–¥–µ—Ä–∂–∞—â–µ–π –∑–∞–¥–∞–Ω–Ω—É—é —Å—Ç—Ä–æ–∫—É.

        Args:
            df (pd.DataFrame): Excel-—Ç–∞–±–ª–∏—Ü–∞, —Å—á–∏—Ç–∞–Ω–Ω–∞—è —á–µ—Ä–µ–∑ pandas.
            target_string (str): –°—Ç—Ä–æ–∫–∞, –∫–æ—Ç–æ—Ä—É—é –Ω—É–∂–Ω–æ –Ω–∞–π—Ç–∏ –≤ —Ç–∞–±–ª–∏—Ü–µ.

        Returns:
            int or None: –ò–Ω–¥–µ–∫—Å –Ω–∞–π–¥–µ–Ω–Ω–æ–π —Å—Ç—Ä–æ–∫–∏, –ª–∏–±–æ None, –µ—Å–ª–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞.
    """
    for index, row in df.iterrows():
        if any(str(cell).strip() == target_string for cell in row):
            return index
    return None
def determine_phi_pr(eta_pr):
    """
        –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ phi_pr –ø–æ –∑–Ω–∞—á–µ–Ω–∏—é eta_pr —Å–æ–≥–ª–∞—Å–Ω–æ –∑–∞–¥–∞–Ω–Ω—ã–º –ø—Ä–∞–≤–∏–ª–∞–º.

        Args:
            eta_pr (float): –ó–Ω–∞—á–µ–Ω–∏–µ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ eta_pr.

        Returns:
            float: –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ phi_pr.
    """

    if eta_pr <= 5:
        return 0.925
    elif eta_pr <= 15:
        return 0.75
    elif eta_pr <= 20:
        return 0.65
    return 1
def extract_k_l_coefficients(sheet, result):
    """
        –ò–∑–≤–ª–µ–∫–∞–µ—Ç –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã K2‚ÄìK6 –∏ L2‚ÄìL5 –∏–∑ Excel-–ª–∏—Å—Ç–∞ –∏ –¥–æ–±–∞–≤–ª—è–µ—Ç –∏—Ö –≤ —Å–ª–æ–≤–∞—Ä—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞.

        Args:
            sheet (openpyxl.worksheet.worksheet.Worksheet): –ê–∫—Ç–∏–≤–Ω—ã–π –ª–∏—Å—Ç Excel.
            result (dict): –°–ª–æ–≤–∞—Ä—å, –≤ –∫–æ—Ç–æ—Ä—ã–π –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã.
    """
    for row_idx, key in zip([2, 3, 4, 5], ["K2", "K3", "K4", "K5"]):
        val = sheet.cell(row=row_idx, column=11).value
        if val is not None and str(val).strip().lower() != "nan":
            result[key] = val
    for row_idx in [6]:
        val = sheet.cell(row=row_idx, column=11).value
        if val is not None and str(val).strip().lower() != "nan":
            result["K6"] = val
    for row_idx, key in zip([2, 3, 4, 5], ["L2", "L3", "L4", "L5"]):
        val = sheet.cell(row=row_idx, column=12).value
        if val is not None and str(val).strip().lower() != "nan":
            result[key] = val
def find_dedal_ikar(file_path_1=None, file_path_2=None):
    """
        –ò–∑–≤–ª–µ–∫–∞–µ—Ç –æ—Å–Ω–æ–≤–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∏–∑ Excel-—Ñ–∞–π–ª–æ–≤, –ø–æ–ª—É—á–µ–Ω–Ω—ã—Ö –∏–∑ —Ä–∞—Å—á—ë—Ç–Ω—ã—Ö –∫–æ–º–ø–ª–µ–∫—Å–æ–≤ –î–µ–¥–∞–ª –∏ –ò–∫–∞—Ä.

        Args:
            file_path_1 (str, optional): –ü—É—Ç—å –∫ —Ñ–∞–π–ª—É Excel –∏–∑ –î–µ–¥–∞–ª–∞.
            file_path_2 (str, optional): –ü—É—Ç—å –∫ —Ñ–∞–π–ª—É Excel –∏–∑ –ò–∫–∞—Ä–∞.

        Returns:
            dict: –°–ª–æ–≤–∞—Ä—å —Å –∫–ª—é—á–µ–≤—ã–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ (–¥–∞–≤–ª–µ–Ω–∏–µ, —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞, —Å–æ—Å—Ç–∞–≤—ã, –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã –∏ —Ç.–¥.).
    """
    result = {}

    if file_path_1:
        df1 = pd.read_excel(file_path_1, header=None)
        idx = find_target_row(df1, '–û—Å–Ω–æ–≤–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã')
        if idx is None:
            raise ValueError("–ù–µ –Ω–∞–π–¥–µ–Ω—ã '–û—Å–Ω–æ–≤–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã' –≤ —Ñ–∞–π–ª–µ 1")
        offsets = {'p': 4, 'T': 5, 'R': 11, 'k': 14}
        wb1 = load_workbook(file_path_1)
        sheet1 = wb1['Sheet1']
        result.update({key: sheet1.cell(row=idx + offset, column=2).value for key, offset in offsets.items()})
        result["k_m0"] = sheet1.cell(row=6, column=2).value
        result["form_gor"] = sheet1.cell(row=1, column=2).value

        form_gor_map = {
            "{'C': 2, 'H': 8, 'N': 2}": '–ù–î–ú–ì',
            "{'H': 2}": '–í–æ–¥–æ—Ä–æ–¥'
        }
        result["cooler_mb"] = form_gor_map.get(result["form_gor"], '–ú–µ—Ç–∞–Ω')
        result["H_gor"] = sheet1.cell(row=2, column=2).value
        result["form_ox"] = sheet1.cell(row=3, column=2).value
        result["H_ox"] = sheet1.cell(row=4, column=2).value

    if file_path_2:
        df2 = pd.read_excel(file_path_2, header=None)
        idx_1 = find_target_row(df2, '–†–∞—Å—Ö–æ–¥ —Ñ-–∫–∏ –æ–∫. –≤ –ø—Ä–∏—Å—Ç–µ–Ω–∫–µ, –∫–≥/—Å')
        idx_2 = find_target_row(df2, '–°–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ –≤ –ø—Ä–∏—Å—Ç–µ–Ω–∫–µ')
        if idx_1 is None:
            raise ValueError("–ù–µ –Ω–∞–π–¥–µ–Ω —Ä–∞—Å—Ö–æ–¥ —Ñ-–∫–∏ –æ–∫. –≤ –ø—Ä–∏—Å—Ç–µ–Ω–∫–µ, –∫–≥/—Å –≤ –ò–∫–∞—Ä–µ")
        if idx_2 is None:
            raise ValueError("–ù–µ –Ω–∞–π–¥–µ–Ω–æ —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ –≤ –ø—Ä–∏—Å—Ç–µ–Ω–∫–µ –≤ –ò–∫–∞—Ä–µ")

        wb2 = load_workbook(file_path_2)
        sheet2 = wb2['Sheet1']
        result["k_m_pr"] = sheet2.cell(row=idx_1 + 5, column=12).value
        result["eta_pr"] = sheet2.cell(row=idx_2, column=3).value
        result["m_gor"] = round(
            sum(float(sheet2.cell(row=idx_2 + delta, column=6).value) for delta in [-4, -3, 0, 1]),
            3
        )
        result["phi_pr"] = determine_phi_pr(result["eta_pr"])
        extract_k_l_coefficients(sheet2, result)

    return result
def find_index_x_y(file_path):
    """
        –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç –¥–∏–∞–ø–∞–∑–æ–Ω —Å—Ç—Ä–æ–∫ –≤ Excel-—Ñ–∞–π–ª–µ, —Å–æ–¥–µ—Ä–∂–∞—â–∏—Ö —á–∏—Å–ª–æ–≤—ã–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã.
        –ü–æ–∏—Å–∫ –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è –æ—Ç —Å—Ç—Ä–æ–∫–∏, —Å–æ–¥–µ—Ä–∂–∞—â–µ–π '–ü–æ–≥—Ä–µ—à–Ω–æ—Å—Ç—å, %', –∏ –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç—Å—è –≤–Ω–∏–∑,
        –ø–æ–∫–∞ —Å—Ç—Ä–æ–∫–∏ —Å–æ–¥–µ—Ä–∂–∞—Ç —á–∏—Å–ª–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ.

        Args:
            file_path (str): –ü—É—Ç—å –∫ Excel-—Ñ–∞–π–ª—É.

        Returns:
            tuple: (start_row_index, end_row_index) ‚Äî –∏–Ω–¥–µ–∫—Å—ã –Ω–∞—á–∞–ª–∞ –∏ –∫–æ–Ω—Ü–∞ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç.
                   –ï—Å–ª–∏ "–ü–æ–≥—Ä–µ—à–Ω–æ—Å—Ç—å, %" –Ω–µ –Ω–∞–π–¥–µ–Ω–∞, –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è (None, None).
    """
    df = pd.read_excel(file_path, header=None)

    # –ü–æ–∏—Å–∫ —Å—Ç—Ä–æ–∫–∏ —Å "–ü–æ–≥—Ä–µ—à–Ω–æ—Å—Ç—å, %"
    target_row_index = next(
        (idx for idx, row in df.iterrows()
         if any(str(cell).strip() == '–ü–æ–≥—Ä–µ—à–Ω–æ—Å—Ç—å, %' for cell in row)),
        None
    )

    if target_row_index is None:
        return None, None

    start_row_index = target_row_index + 4

    # –ü–æ–∏—Å–∫ –∫–æ–Ω—Ü–∞ –¥–∏–∞–ø–∞–∑–æ–Ω–∞ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç
    end_row_index = len(df)
    for idx in range(start_row_index, len(df)):
        row = df.iloc[idx]
        if not pd.to_numeric(row, errors='coerce').notna().any():
            end_row_index = idx - 1
            break

    return start_row_index, end_row_index
def save_coord_x_y(start_row_index, end_row_index,file_path):
    """
        –ò–∑–≤–ª–µ–∫–∞–µ—Ç –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã X –∏ Y –∏–∑ Excel-—Ñ–∞–π–ª–∞ –∏ –¥–æ–±–∞–≤–ª—è–µ—Ç –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–µ —Ç–æ—á–∫–∏
        –º–µ–∂–¥—É –ø–µ—Ä–≤—ã–º–∏ –¥–≤—É–º—è –æ—Ç—Ä–µ–∑–∫–∞–º–∏ —Å —Ä–∞–≤–Ω–æ–º–µ—Ä–Ω—ã–º —à–∞–≥–æ–º.

        –ê–ª–≥–æ—Ä–∏—Ç–º:
        1. –ü–µ—Ä–≤–∞—è —Ç–æ—á–∫–∞ (X=0, Y=Y0) –Ω–æ—Ä–º–∞–ª–∏–∑—É–µ—Ç—Å—è –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –ø–µ—Ä–≤–æ–π X-–∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã.
        2. –ú–µ–∂–¥—É –ø–µ—Ä–≤–æ–π –∏ –≤—Ç–æ—Ä–æ–π —Ç–æ—á–∫–∞–º–∏ –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è 50 —Ä–∞–≤–Ω–æ–º–µ—Ä–Ω—ã—Ö —Ç–æ—á–µ–∫.
        3. –í—Ç–æ—Ä–∞—è —Ç–æ—á–∫–∞ (X=50 –º–º) –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è —è–≤–Ω–æ.
        4. –ú–µ–∂–¥—É –≤—Ç–æ—Ä–æ–π –∏ —Ç—Ä–µ—Ç—å–µ–π —Ç–æ—á–∫–∞–º–∏ (–∏–∑ Excel) –≤—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è 100 —Ç–æ—á–µ–∫.
        5. –¢—Ä–µ—Ç—å—è —Ç–æ—á–∫–∞ –∏–∑ Excel –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è.
        6. –î–∞–ª–µ–µ –∏–¥—É—Ç –æ—Å—Ç–∞–ª—å–Ω—ã–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –∏–∑ Excel.

        Args:
            start_row_index (int): –ò–Ω–¥–µ–∫—Å —Å—Ç—Ä–æ–∫–∏, —Å –∫–æ—Ç–æ—Ä–æ–π –Ω–∞—á–∏–Ω–∞—é—Ç—Å—è –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –≤ Excel.
            end_row_index (int): –ò–Ω–¥–µ–∫—Å —Å—Ç—Ä–æ–∫–∏, –Ω–∞ –∫–æ—Ç–æ—Ä–æ–π –∑–∞–∫–∞–Ω—á–∏–≤–∞—é—Ç—Å—è –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –≤ Excel.
            file_path (str): –ü—É—Ç—å –∫ Excel-—Ñ–∞–π–ª—É.

        Returns:
            tuple: –°–ø–∏—Å–∫–∏ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç X –∏ Y –≤ –º–µ—Ç—Ä–∞—Ö.
    """
    wb = load_workbook(file_path)
    sheet = wb['Sheet1']

    X, Y = [], []

    x0 = sheet.cell(row=start_row_index, column=1).value / 1000  # –º–º ‚Üí –º
    y0 = sheet.cell(row=start_row_index, column=2).value / 1000

    X.append(0.0)
    Y.append(y0)

    x2 = 0.050  # 50 –º–º
    step = x2 / 51
    X += [i * step for i in range(1, 51)]
    Y += [y0] * 50
    X.append(x2)
    Y.append(y0)

    x3 = sheet.cell(row=start_row_index + 1, column=1).value / 1000 - x0
    y3 = sheet.cell(row=start_row_index + 1, column=2).value / 1000
    step = (x3 - x2) / 101
    X += [x2 + i * step for i in range(1, 101)]
    Y += [y0] * 100
    X.append(x3)
    Y.append(y3)

    for i in range(start_row_index + 2, end_row_index + 1):
        xi = sheet.cell(row=i, column=1).value / 1000 - x0
        yi = sheet.cell(row=i, column=2).value / 1000
        X.append(xi)
        Y.append(yi)

    return X, Y
def filtred_array(arr,arr_2):
    """
        –§–∏–ª—å—Ç—Ä—É–µ—Ç –º–∞—Å—Å–∏–≤ arr, —É–¥–∞–ª—è—è –ø–æ–¥—Ä—è–¥ –∏–¥—É—â–∏–µ –æ–¥–∏–Ω–∞–∫–æ–≤—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã.
        –û–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ —É–¥–∞–ª—è—é—Ç—Å—è —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ —ç–ª–µ–º–µ–Ω—Ç—ã –∏–∑ arr_2.

        Args:
            arr (list): –°–ø–∏—Å–æ–∫ –∑–Ω–∞—á–µ–Ω–∏–π, –≤ –∫–æ—Ç–æ—Ä–æ–º –Ω—É–∂–Ω–æ —É–¥–∞–ª–∏—Ç—å –ø–æ–¥—Ä—è–¥ –¥—É–±–ª–∏—Ä—É—é—â–∏–µ—Å—è —ç–ª–µ–º–µ–Ω—Ç—ã.
            arr_2 (list): –°–æ–ø—É—Ç—Å—Ç–≤—É—é—â–∏–π —Å–ø–∏—Å–æ–∫ –∑–Ω–∞—á–µ–Ω–∏–π, —Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π —Å arr.

        Returns:
            tuple: (filtered_arr, filtered_arr_2) ‚Äî —Å–ø–∏—Å–∫–∏ –±–µ–∑ –ø–æ–≤—Ç–æ—Ä–æ–≤ –ø–æ arr.
    """
    result = []
    result_2 = []
    for i in range(len(arr)):
        if i == 0 or arr[i] != arr[i - 1]:
            result.append(arr[i])
            result_2.append(arr_2[i])
    return result, result_2
def okr_2(x):
    """
    –û–∫—Ä—É–≥–ª—è–µ—Ç —á–∏—Å–ª–æ –≤–Ω–∏–∑ –¥–æ –±–ª–∏–∂–∞–π—à–µ–≥–æ —á—ë—Ç–Ω–æ–≥–æ —Ü–µ–ª–æ–≥–æ —á–∏—Å–ª–∞.

    Args:
        x (float): –í—Ö–æ–¥–Ω–æ–µ —á–∏—Å–ª–æ.

    Returns:
        int: –ë–ª–∏–∂–∞–π—à–µ–µ —á—ë—Ç–Ω–æ–µ —á–∏—Å–ª–æ, –Ω–µ –±–æ–ª—å—à–µ x.
    """
    x_floor = math.floor(x)
    return x_floor if x_floor % 2 == 0 else x_floor - 1
def find_n_min(beta_reb, t_n_min, d_kp, delta_st, h):
    """
    –í—ã—á–∏—Å–ª—è–µ—Ç –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä–∞—Å—á—ë—Ç–Ω—ã—Ö —Å–µ—á–µ–Ω–∏–π –≤–¥–æ–ª—å –∫–∞–Ω–∞–ª–∞ –æ—Ö–ª–∞–∂–¥–µ–Ω–∏—è (n_min),
    –æ–∫—Ä—É–≥–ª—ë–Ω–Ω–æ–µ –≤–Ω–∏–∑ –¥–æ –±–ª–∏–∂–∞–π—à–µ–≥–æ —á—ë—Ç–Ω–æ–≥–æ —á–∏—Å–ª–∞.

    –§–æ—Ä–º—É–ª–∞:
        D‚ÇÄ.‚ÇÖ = d_kp * (1 + (2 * delta_st + h) / d_kp)
        n = œÄ * D‚ÇÄ.‚ÇÖ * cos(beta_reb) / (t_n_min / 1000)
        n_min = –æ–∫—Ä—É–≥–ª–µ–Ω–∏–µ –≤–Ω–∏–∑ –¥–æ –±–ª–∏–∂–∞–π—à–µ–≥–æ —á—ë—Ç–Ω–æ–≥–æ

    Args:
        beta_reb (float): –£–≥–æ–ª —Ä–µ–±—Ä–∞ –≤ —Ä–∞–¥–∏–∞–Ω–∞—Ö.
        t_n_min (float): –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π —à–∞–≥ —Å–µ—á–µ–Ω–∏—è (–≤ –º–∏–ª–ª–∏–º–µ—Ç—Ä–∞—Ö).
        d_kp (float): –í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π –¥–∏–∞–º–µ—Ç—Ä –∫–∞–Ω–∞–ª–∞ –æ—Ö–ª–∞–∂–¥–µ–Ω–∏—è (–≤ –º–µ—Ç—Ä–∞—Ö).
        delta_st (float): –¢–æ–ª—â–∏–Ω–∞ —Å—Ç–µ–Ω–∫–∏ (–≤ –º–µ—Ç—Ä–∞—Ö).
        h (float): –í—ã—Å–æ—Ç–∞ –∫–∞–Ω–∞–ª–∞ (–≤ –º–µ—Ç—Ä–∞—Ö).

    Returns:
        int: –ú–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ —á—ë—Ç–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä–∞—Å—á—ë—Ç–Ω—ã—Ö —Å–µ—á–µ–Ω–∏–π (n_min).
    """
    D_05_kp = d_kp * (1 + (2 * delta_st + h) / d_kp)
    n_r_kp_min_0 = (math.pi * D_05_kp * math.cos(beta_reb)) / (t_n_min / 1000)
    n_r_kp_min = okr_2(n_r_kp_min_0)
    return n_r_kp_min
def find_n_r_array(X, Y, n_r_kp_min, beta_reb, delta_st, h, t_n_max):
    """
    –í—ã—á–∏—Å–ª—è–µ—Ç –º–∞—Å—Å–∏–≤ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —Ä–∞—Å—á—ë—Ç–Ω—ã—Ö —Å–µ—á–µ–Ω–∏–π `n_r` –ø–æ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–µ Y,
    –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –¥–∏–∞–º–µ—Ç—Ä–∞ –∫–∞–Ω–∞–ª–∞ (–ø—Ä–æ–ø–æ—Ä—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–≥–æ 2*r) –∏ –ø—Ä–∞–≤–∏–ª–∞ –¥–∏—Å–∫—Ä–µ—Ç–∏–∑–∞—Ü–∏–∏.

    –ü–æ—Ä–æ–≥–æ–≤—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è D —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞—é—Ç—Å—è –ø–æ —Ñ–æ—Ä–º—É–ª–µ:
        D_i = ((t_n_max * multiplier * n_r_kp_min) / (œÄ * cos(beta))) - (2 * delta_st + h)

    –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–µ—á–µ–Ω–∏–π —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç—Å—è —Å—Ç—É–ø–µ–Ω—á–∞—Ç–æ –ø–æ –º–µ—Ä–µ —Ä–æ—Å—Ç–∞ –¥–∏–∞–º–µ—Ç—Ä–∞.

    Args:
        X (list of float): –ö–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã X (–Ω–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –≤ —Ä–∞—Å—á—ë—Ç–µ, –Ω–æ –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è –ø–æ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—É).
        Y (list of float): –ö–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã Y (–≤ –º–µ—Ç—Ä–∞—Ö), –ø–æ –∫–æ—Ç–æ—Ä—ã–º –±—É–¥–µ—Ç –æ–ø—Ä–µ–¥–µ–ª—è—Ç—å—Å—è –¥–∏–∞–º–µ—Ç—Ä.
        n_r_kp_min (int): –ú–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–µ—á–µ–Ω–∏–π.
        beta_reb (float): –£–≥–æ–ª —Ä–µ–±—Ä–∞ –≤ —Ä–∞–¥–∏–∞–Ω–∞—Ö.
        delta_st (float): –¢–æ–ª—â–∏–Ω–∞ —Å—Ç–µ–Ω–∫–∏ (–≤ –º–µ—Ç—Ä–∞—Ö).
        h (float): –í—ã—Å–æ—Ç–∞ –∫–∞–Ω–∞–ª–∞ (–≤ –º–µ—Ç—Ä–∞—Ö).
        t_n_max (float): –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —à–∞–≥ —Å–µ—á–µ–Ω–∏—è (–≤ –º–∏–ª–ª–∏–º–µ—Ç—Ä–∞—Ö).

    Returns:
        list of int: –ú–∞—Å—Å–∏–≤ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —Å–µ—á–µ–Ω–∏–π n_r –¥–ª—è –∫–∞–∂–¥–æ–π —Ç–æ—á–∫–∏ –ø–æ Y.
    """
    multipliers = [1, 2, 4, 8, 16]
    D = [
        (t_n_max * m * n_r_kp_min / 1000) / (math.pi * math.cos(beta_reb)) - (2 * delta_st + h)
        for m in multipliers
    ]

    n_r_array = []
    for r in Y:
        diameter = 2 * r
        if diameter < D[0]:
            n_r_array.append(n_r_kp_min)
        elif diameter < D[1]:
            n_r_array.append(2 * n_r_kp_min)
        elif diameter < D[2]:
            n_r_array.append(4 * n_r_kp_min)
        elif diameter < D[3]:
            n_r_array.append(8 * n_r_kp_min)
        elif diameter < D[4]:
            n_r_array.append(16 * n_r_kp_min)
        else:
            n_r_array.append(32 * n_r_kp_min)

    return n_r_array
def equation(lambda_, k, F_otn_i):
    """
    –†–∞—Å—á—ë—Ç –∑–Ω–∞—á–µ–Ω–∏—è —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è –ø–æ–¥–±–æ—Ä–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è –ø–æ—Ç–æ–∫–∞ Œª (–ª—è–º–±–¥–∞) –ø–æ –∑–∞–¥–∞–Ω–Ω–æ–º—É –æ—Ç–Ω–æ—à–µ–Ω–∏—é –ø–ª–æ—â–∞–¥–µ–π.

    –≠—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –≤—ã—Ä–∞–∂–µ–Ω–∏–µ, –∫–æ—Ä–µ–Ω—å –∫–æ—Ç–æ—Ä–æ–≥–æ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –∏—Å–∫–æ–º–æ–º—É –∑–Ω–∞—á–µ–Ω–∏—é Œª –≤ —É—Ä–∞–≤–Ω–µ–Ω–∏–∏
    –¥–ª—è –∏–∑—ç–Ω—Ç—Ä–æ–ø–∏—á–µ—Å–∫–æ–≥–æ –∏—Å—Ç–µ—á–µ–Ω–∏—è –≥–∞–∑–∞ —á–µ—Ä–µ–∑ —Å–æ–ø–ª–æ:

        Œª ¬∑ [1 - Œª¬≤ ¬∑ ((k - 1)/(k + 1))]^(1 / (k - 1)) ¬∑ [(k + 1)/2]^(1 / (k - 1)) = 1 / F_otn_i

    –ì–¥–µ:
        - Œª ‚Äî –æ—Ç–Ω–æ—à–µ–Ω–∏–µ –ª–æ–∫–∞–ª—å–Ω–æ–π —Å–∫–æ—Ä–æ—Å—Ç–∏ –ø–æ—Ç–æ–∫–∞ –∫ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–æ–π (—Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ),
        - k ‚Äî –ø–æ–∫–∞–∑–∞—Ç–µ–ª—å –∞–¥–∏–∞–±–∞—Ç—ã –≥–∞–∑–∞ (–æ–±—ã—á–Ω–æ 1.2‚Äì1.4),
        - F_otn_i ‚Äî –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ–µ –æ—Ç–Ω–æ—à–µ–Ω–∏–µ –ø–ª–æ—â–∞–¥–µ–π F/F_–∫—Ä –≤ —Ä–∞—Å—Å–º–∞—Ç—Ä–∏–≤–∞–µ–º–æ–º —Å–µ—á–µ–Ω–∏–∏ —Å–æ–ø–ª–∞.

    –í–æ–∑–≤—Ä–∞—â–∞–µ–º–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ ‚Äî –ª–µ–≤–∞—è —á–∞—Å—Ç—å —É—Ä–∞–≤–Ω–µ–Ω–∏—è –º–∏–Ω—É—Å –ø—Ä–∞–≤–∞—è,
    –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø—Ä–∏ —á–∏—Å–ª–µ–Ω–Ω–æ–º —Ä–µ—à–µ–Ω–∏–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –º–µ—Ç–æ–¥–æ–º –ë—Ä–µ–Ω—Ç–∞ –∏–ª–∏ –ù—å—é—Ç–æ–Ω–∞) –¥–ª—è –Ω–∞—Ö–æ–∂–¥–µ–Ω–∏—è –∫–æ—Ä–Ω—è.

    –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:
    - –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç `np.nan`, –µ—Å–ª–∏ –≤—ã—Ä–∞–∂–µ–Ω–∏–µ –ø–æ–¥ –∫–æ—Ä–Ω–µ–º –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω–æ –∏–ª–∏ –¥–∞–Ω–Ω—ã–µ –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã.
    - –ü—Ä–µ–¥—É—Å–º–æ—Ç—Ä–µ–Ω–∞ –∑–∞—â–∏—Ç–∞ –æ—Ç –¥–µ–ª–µ–Ω–∏—è –Ω–∞ –Ω–æ–ª—å –∏ –∫–æ–º–ø–ª–µ–∫—Å–Ω—ã—Ö —á–∏—Å–µ–ª (–≤–æ–∑–≤–µ–¥–µ–Ω–∏–µ –≤ —Å—Ç–µ–ø–µ–Ω—å –¥—Ä–æ–±–Ω–æ–π —Å—Ç–µ–ø–µ–Ω–∏).

    Args:
        lambda_ (float): –ü—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ–º–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–∞ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è –ø–æ—Ç–æ–∫–∞.
        k (float): –ü–æ–∫–∞–∑–∞—Ç–µ–ª—å –∞–¥–∏–∞–±–∞—Ç—ã —Ä–∞–±–æ—á–µ–≥–æ —Ç–µ–ª–∞.
        F_otn_i (float): –û—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ–µ –æ—Ç–Ω–æ—à–µ–Ω–∏–µ –ø–ª–æ—â–∞–¥–µ–π F / F_–∫—Ä –¥–ª—è –¥–∞–Ω–Ω–æ–≥–æ —Å–µ—á–µ–Ω–∏—è.

    Returns:
        float: –ó–Ω–∞—á–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ (–ª–µ–≤–∞—è —á–∞—Å—Ç—å –º–∏–Ω—É—Å –ø—Ä–∞–≤–∞—è), –ª–∏–±–æ np.nan –ø—Ä–∏ –æ—à–∏–±–∫–µ –∏–ª–∏ –Ω–µ–¥–æ–ø—É—Å—Ç–∏–º–æ–º Œª.
    """
    try:
        if lambda_ <= 0 or F_otn_i <= 0 or k <= 1:
            return np.nan

        term2_base = 1 - (lambda_ ** 2) * ((k - 1) / (k + 1))
        if term2_base <= 0:
            return np.nan  # –∏–∑–±–µ–≥–∞–µ–º –∫–æ–º–ø–ª–µ–∫—Å–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π

        term2 = term2_base ** (1 / (k - 1))
        term3 = ((k + 1) / 2) ** (1 / (k - 1))

        return float(lambda_ * term2 * term3 - (1 / F_otn_i))

    except Exception as e:
        print(f"–û—à–∏–±–∫–∞ –≤ equation(): {e}, Œª={lambda_}, k={k}, F={F_otn_i}")
        return np.nan
def solve_lambda(F_i, k, lower=0.01, upper=4.0, xtol=1e-6):
    """
    –ù–∞–¥—ë–∂–Ω—ã–π —á–∏—Å–ª–µ–Ω–Ω—ã–π –ø–æ–¥–±–æ—Ä –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–∞ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è –ø–æ—Ç–æ–∫–∞ Œª –º–µ—Ç–æ–¥–æ–º –ë—Ä–µ–Ω—Ç–∞.

    –§—É–Ω–∫—Ü–∏—è —Ä–µ—à–∞–µ—Ç –∏–∑—ç–Ω—Ç—Ä–æ–ø–∏—á–µ—Å–∫–æ–µ —É—Ä–∞–≤–Ω–µ–Ω–∏–µ –∏—Å—Ç–µ—á–µ–Ω–∏—è –≥–∞–∑–∞ –∏–∑ —Å–æ–ø–ª–∞ (—Å–º. —Ñ—É–Ω–∫—Ü–∏—é `equation(...)`) –¥–ª—è –∑–∞–¥–∞–Ω–Ω–æ–≥–æ
    –æ—Ç–Ω–æ—à–µ–Ω–∏—è –ø–ª–æ—â–∞–¥–µ–π F/F_–∫—Ä –∏ –ø–æ–∫–∞–∑–∞—Ç–µ–ª—è –∞–¥–∏–∞–±–∞—Ç—ã k, –≤–æ–∑–≤—Ä–∞—â–∞—è —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ Œª ‚Äî –±–µ–∑—Ä–∞–∑–º–µ—Ä–Ω–æ–≥–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞,
    –æ—Ç—Ä–∞–∂–∞—é—â–µ–≥–æ —Å—Ç–µ–ø–µ–Ω—å —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è –ø–æ—Ç–æ–∫–∞ –≤ –¥–∞–Ω–Ω–æ–º —Å–µ—á–µ–Ω–∏–∏ —Å–æ–ø–ª–∞.

    –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –º–µ—Ç–æ–¥ `brentq` –∏–∑ `scipy.optimize.root_scalar`, –ø—Ä–∏ —ç—Ç–æ–º:
    - –ü—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –¥–æ–ø—É—Å—Ç–∏–º–æ—Å—Ç—å –∏–Ω—Ç–µ—Ä–≤–∞–ª–∞ –ø–æ–∏—Å–∫–∞ (`bracket`) ‚Äî –∑–Ω–∞–∫ —Ñ—É–Ω–∫—Ü–∏–∏ –Ω–∞ –∫–æ–Ω—Ü–∞—Ö –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —Ä–∞–∑–Ω—ã–º;
    - –í—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ `upper`, —á—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å –∫–æ–º–ø–ª–µ–∫—Å–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π –≤ —É—Ä–∞–≤–Ω–µ–Ω–∏–∏ (–ø–æ Œª¬≤ < (k + 1)/(k - 1));
    - –ï—Å–ª–∏ –∫–æ—Ä–µ–Ω—å –Ω–∞—Ö–æ–¥–∏—Ç—Å—è —Ç–æ—á–Ω–æ –Ω–∞ –≥—Ä–∞–Ω–∏—Ü–µ ‚Äî –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è `lower` –∏–ª–∏ `upper`;
    - –ü—Ä–∏ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–∏ –æ—à–∏–±–æ–∫ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è `None`.

    Args:
        F_i (float): –û—Ç–Ω–æ—à–µ–Ω–∏–µ –ø–ª–æ—â–∞–¥–µ–π F / F_–∫—Ä –≤ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π —Ç–æ—á–∫–µ —Å–æ–ø–ª–∞.
        k (float): –ü–æ–∫–∞–∑–∞—Ç–µ–ª—å –∞–¥–∏–∞–±–∞—Ç—ã –≥–∞–∑–∞.
        lower (float): –õ–µ–≤–∞—è –≥—Ä–∞–Ω–∏—Ü–∞ –ø–æ–∏—Å–∫–∞ Œª (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 0.01).
        upper (float): –ü—Ä–∞–≤–∞—è –≥—Ä–∞–Ω–∏—Ü–∞ –ø–æ–∏—Å–∫–∞ Œª (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 4.0).
        xtol (float): –ê–±—Å–æ–ª—é—Ç–Ω–∞—è —Ç–æ—á–Ω–æ—Å—Ç—å –ø–æ–¥–±–æ—Ä–∞ –∫–æ—Ä–Ω—è (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 1e-6).

    Returns:
        float or None: –ù–∞–π–¥–µ–Ω–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ Œª, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–µ –∑–∞–¥–∞–Ω–Ω–æ–º—É F_i –∏ k, –ª–∏–±–æ None –ø—Ä–∏ —Å–±–æ–µ –∏–ª–∏ –Ω–µ–¥–æ–ø—É—Å—Ç–∏–º–æ–º –∏–Ω—Ç–µ—Ä–≤–∞–ª–µ.
    """
    try:
        lambda_max = math.sqrt((k + 1) / (k - 1))
        upper = min(upper, lambda_max - 1e-6)

        f_a = equation(lower, k, F_i)
        f_b = equation(upper, k, F_i)

        # ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–æ—Ä–Ω—è –Ω–∞ –≥—Ä–∞–Ω–∏—Ü–µ
        if abs(f_a) < 1e-8:
            return lower
        if abs(f_b) < 1e-8:
            return upper

        if any([
            isinstance(f_a, complex), isinstance(f_b, complex),
            np.isnan(f_a), np.isnan(f_b),
            f_a * f_b > 0
        ]):
            print(f"‚ö†Ô∏è –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –∏–Ω—Ç–µ—Ä–≤–∞–ª: F={F_i}, f(a)={f_a}, f(b)={f_b}")
            return None

        sol = root_scalar(
            equation,
            args=(k, F_i),
            bracket=[lower, upper],
            method='brentq',
            xtol=xtol
        )

        if not sol.converged:
            print(f"‚ö†Ô∏è –ö–æ—Ä–µ–Ω—å –Ω–µ –Ω–∞–π–¥–µ–Ω —Ç–æ—á–Ω–æ –¥–ª—è F={F_i}")
        return sol.root

    except Exception as e:
        print(f"‚ùå –û—à–∏–±–∫–∞ –≤ solve_lambda: {e}")
        return None
def find_q_kon(number, Y, c_p_T_0g, c_p_T_st, T_st_g, T_og, mu_og, R_og, D_otn, d_kp, F_otn, b, p_k, k, iter):
    """
    –†–∞—Å—á—ë—Ç —Ç–µ–ø–ª–æ–≤–æ–≥–æ –ø–æ—Ç–æ–∫–∞ q –∫ —Å—Ç–µ–Ω–∫–µ –∫–∞–Ω–∞–ª–∞ –ñ–†–î —Å —É—á—ë—Ç–æ–º –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –≥–∞–∑–∞, –≥–µ–æ–º–µ—Ç—Ä–∏–∏ –∏ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–Ω—ã—Ö —É—Å–ª–æ–≤–∏–π.

    Args:
        number (list of int): –ò–Ω–¥–µ–∫—Å—ã —Ä–∞—Å—á—ë—Ç–Ω—ã—Ö —Ç–æ—á–µ–∫.
        Y (list of float): –†–∞–¥–∏–∞–ª—å–Ω—ã–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã —Ç–æ—á–µ–∫.
        c_p_T_0g (float): –¢–µ–ø–ª–æ—ë–º–∫–æ—Å—Ç—å –≥–∞–∑–∞ –ø—Ä–∏ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–µ –≥–∞–∑–∞.
        c_p_T_st (list of float): –¢–µ–ø–ª–æ—ë–º–∫–æ—Å—Ç—å –≤ —Å—Ç–µ–Ω–∫–µ (–ø–æ —Ç–æ—á–∫–∞–º).
        T_st_g (list of float): –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ —Å—Ç–µ–Ω–∫–∏ –≥–∞–∑–∞ (–ø–æ —Ç–æ—á–∫–∞–º).
        T_og (float): –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –≥–∞–∑–∞.
        mu_og (float): –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∞—è –≤—è–∑–∫–æ—Å—Ç—å –≥–∞–∑–∞.
        R_og (float): –ì–∞–∑–æ–≤–∞—è –ø–æ—Å—Ç–æ—è–Ω–Ω–∞—è –¥–ª—è –≥–∞–∑–∞.
        D_otn (list of float): –û—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–π –¥–∏–∞–º–µ—Ç—Ä –≤ —Ç–æ—á–∫–∞—Ö.
        d_kp (float): –î–∏–∞–º–µ—Ç—Ä –∫–∞–Ω–∞–ª–∞.
        F_otn (list of float): –û—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ–µ —Å–µ—á–µ–Ω–∏–µ.
        b (float): –®–∏—Ä–∏–Ω–∞ —â–µ–ª–∏ –æ—Ö–ª–∞–∂–¥–µ–Ω–∏—è (–≤ –º–º).
        p_k (float): –î–∞–≤–ª–µ–Ω–∏–µ –≤ –∫–∞–º–µ—Ä–µ (–≤ –ú–ü–∞).
        k (float): –ü–æ–∫–∞–∑–∞—Ç–µ–ª—å –∞–¥–∏–∞–±–∞—Ç—ã.
        iter (int): –ò—Ç–µ—Ä–∏—Ä—É–µ–º–∞—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è (–Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ –ª–æ–≥–∏–∫–µ, –≤–æ–∑–º–æ–∂–Ω–æ –∑–∞—Ä–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–∞).

    Returns:
        tuple: (q, betta, T_st_otn, lambd, S_1)
            q (list of float): –¢–µ–ø–ª–æ–≤–æ–π –ø–æ—Ç–æ–∫ –∫ —Å—Ç–µ–Ω–∫–µ.
            betta (list of float): –ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç —Å–∫–æ—Ä–æ—Å—Ç–∏.
            T_st_otn (list of float): –û—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–∞—è —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ —Å—Ç–µ–Ω–∫–∏.
            lambd (list of float): –ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è –ø–æ—Ç–æ–∫–∞.
            S_1 (list of float): –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω–∞—è —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞ —Ç–µ–ø–ª–æ–æ—Ç–¥–∞—á–∏.
    """
    lambd = []
    betta = []

    for i in number:
        F_i = F_otn[i]

        if i <= Y.index(min(Y)):  # –î–æ –∫—Ä–∏—Ç–∏–∫–∏ ‚Üí –¥–æ–∑–≤—É–∫
            lambd_i = solve_lambda(F_i, k, lower=0.01, upper=1.0)
        else:  # –ü–æ—Å–ª–µ –∫—Ä–∏—Ç–∏–∫–∏ ‚Üí —Å–≤–µ—Ä—Ö–∑–≤—É–∫
            lambd_i = solve_lambda(F_i, k, lower=1.0, upper=4.0)

        if lambd_i is None:
            lambd_i = 0  # –∏–ª–∏ np.nan, –∏–ª–∏ continue
        lambd.append(lambd_i)

        betta.append(lambd_i * math.sqrt((k - 1) / (k + 1)))

    c_p_sr = [0.5 * (c_p_T_0g + c_p_st_i) for c_p_st_i in c_p_T_st]

    T_st_otn = [T_st / T_og for T_st in T_st_g]

    S_1 = [
        (2.065 * c_p_sr[i] * (T_og - T_st_g[i]) * (mu_og ** 0.15)) /
        (((R_og * T_og) ** 0.425) *
         ((1 + T_st_otn[i]) ** 0.595) *
         ((3 + T_st_otn[i]) ** 0.15))
        for i in range(len(number))
    ]

    slab_alpha = 1.813 * ((2 / (k + 1)) ** (0.85 / (k - 1))) * ((2 * k / (k + 1)) ** 0.425)

    slab_zed = [
        1.769 * ((1 - betta[i] ** 2 + betta[i] ** 2 *
                  (1 - 0.086 * (1 - betta[i] ** 2) /
                   (1 - T_st_otn[i] - 0.1 * betta[i] ** 2))) /
                 (1 - T_st_otn[i] - 0.1 * betta[i] ** 2)) ** 0.54
        for i in range(len(number))
    ]

    A = 0.01352
    B = [0.4842 * A * slab_alpha * slab_zed[i] for i in range(len(number))]

    q = [
        b * 1e-6 * B[i] * (((1 - betta[i] ** 2) * (p_k * 1e6) ** 0.85 * S_1[i]) /
                          (D_otn[i] ** 1.82 * d_kp ** 0.15 * 0.75 ** 0.58))
        for i in range(len(number))
    ]

    return q, betta, T_st_otn, lambd, S_1
def find_l_e_D(M_co2, M, p_k, M_h2o, X, Y, R_k, T_k):
    """
    –í—ã—á–∏—Å–ª—è–µ—Ç —Å—Ç–µ–ø–µ–Ω—å —á—ë—Ä–Ω–æ—Ç–µ–ª–æ—Å—Ç–∏ –ø—Ä–æ–¥—É–∫—Ç–æ–≤ —Å–≥–æ—Ä–∞–Ω–∏—è (eps_g) –Ω–∞ –æ—Å–Ω–æ–≤–µ
    –≥–µ–æ–º–µ—Ç—Ä–∏–∏ –∫–∞–Ω–∞–ª–∞ –∏ —Å–æ—Å—Ç–∞–≤–∞ –≥–∞–∑–æ–≤ (CO2 –∏ H2O).

    Args:
        M_co2 (float): –ú–∞—Å—Å–æ–≤–∞—è –¥–æ–ª—è CO2.
        M (float): –û–±—â–∞—è –º–∞—Å—Å–∞ –ø—Ä–æ–¥—É–∫—Ç–æ–≤ —Å–≥–æ—Ä–∞–Ω–∏—è.
        p_k (float): –î–∞–≤–ª–µ–Ω–∏–µ –≤ –∫–∞–º–µ—Ä–µ (–≤ –ú–ü–∞).
        M_h2o (float): –ú–∞—Å—Å–æ–≤–∞—è –¥–æ–ª—è H2O.
        X (list of float): –°–ø–∏—Å–æ–∫ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç X.
        Y (list of float): –°–ø–∏—Å–æ–∫ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç Y.
        R_k (float): –ì–∞–∑–æ–≤–∞—è –ø–æ—Å—Ç–æ—è–Ω–Ω–∞—è.
        T_k (float): –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ —Å—Ç–µ–Ω–∫–∏ (–≤ K).

    Returns:
        float: –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–∞—è —Å—Ç–µ–ø–µ–Ω—å —á—ë—Ä–Ω–æ—Ç–µ–ª–æ—Å—Ç–∏ –≥–∞–∑–æ–≤ (eps_g).
    """
    p_co2 = (M_co2 / M) * p_k
    p_h2o = (M_h2o / M) * p_k

    x_value = X[1] / (2 * Y[0])
    x = np.array([1, 1.5, 2.5, 4])
    y = np.array([0.6, 0.75, 0.85, 0.9])
    y_value = np.interp(x_value, x, y, left=y[0], right=y[-1])
    L_e = y_value * 2 * Y[0]

    ro_h2o = (p_h2o * 1e6) / (R_k * T_k)
    ro_h2o_l_e = ro_h2o * L_e
    lg_ro_h2o_l_e = math.log10(ro_h2o_l_e)

    eps_0_h2o = 0.14
    beta_h2o = 1.86
    eps_h2o = beta_h2o * eps_0_h2o

    return eps_h2o
def find_q_l(eps_g, T_k, phi, D_otn, number, Y):
    """
    –†–∞—Å—á—ë—Ç –ª—É—á–∏—Å—Ç–æ–≥–æ —Ç–µ–ø–ª–æ–≤–æ–≥–æ –ø–æ—Ç–æ–∫–∞ (q_l) –≤ —Ä–∞–∑–Ω—ã—Ö —Å–µ—á–µ–Ω–∏—è—Ö –∫–∞–Ω–∞–ª–∞ –æ—Ö–ª–∞–∂–¥–µ–Ω–∏—è.

    Args:
        eps_g (float): –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–∞—è —Å—Ç–µ–ø–µ–Ω—å —á—ë—Ä–Ω–æ—Ç–µ–ª–æ—Å—Ç–∏ –ø—Ä–æ–¥—É–∫—Ç–æ–≤ —Å–≥–æ—Ä–∞–Ω–∏—è.
        T_k (float): –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ —Å—Ç–µ–Ω–∫–∏ (K).
        phi (float): –ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ–π –ø–ª–æ—â–∞–¥–∏.
        D_otn (list of float): –°–ø–∏—Å–æ–∫ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã—Ö –¥–∏–∞–º–µ—Ç—Ä–æ–≤.
        number (list of int): –ò–Ω–¥–µ–∫—Å—ã —Ä–∞—Å—á—ë—Ç–Ω—ã—Ö —Å–µ—á–µ–Ω–∏–π.
        Y (list of float): –†–∞–¥–∏–∞–ª—å–Ω—ã–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã.

    Returns:
        list of float: –°–ø–∏—Å–æ–∫ –ª—É—á–∏—Å—Ç—ã—Ö —Ç–µ–ø–ª–æ–≤—ã—Ö –ø–æ—Ç–æ–∫–æ–≤ [–ú–í—Ç/–º¬≤].
    """
    eps_st = 0.8
    eps_st_ef = 0.5 * (eps_st + 1)
    c_0 = 5.67  # –ü–æ—Å—Ç–æ—è–Ω–Ω–∞—è –°—Ç–µ—Ñ–∞–Ω–∞-–ë–æ–ª—å—Ü–º–∞–Ω–∞ * 10‚Åª‚Å∏

    q_l_km = eps_st_ef * eps_g * c_0 * ((T_k / 100) ** 4)
    q_l_kc = q_l_km * phi

    comparison_number = 1.2
    index_of_element = next((idx for idx, val in enumerate(D_otn) if val < comparison_number), -1)

    q_l = []
    for i in number:
        if i <= 51:
            # –õ–∏–Ω–µ–π–Ω—ã–π —Ä–æ—Å—Ç –º–µ–∂–¥—É 0.25 –∏ –ø–æ–ª–Ω–æ–π –º–æ—â–Ω–æ—Å—Ç—å—é –Ω–∞ 51 —Ç–æ—á–∫–∞—Ö
            base = q_l_km * 0.25 * 1e-6
            delta = (q_l_km * phi * 1e-6) - base
            q_l.append(base + delta * (i / 51))
        elif i < index_of_element:
            q_l.append(q_l_km * phi * 1e-6)
        elif i >= index_of_element and i < Y.index(min(Y)):
            q_l.append(q_l_kc * 1e-6 * (1 - 12.5 * ((1.2 - D_otn[i]) ** 2)))
        elif i == Y.index(min(Y)):
            q_l.append(0.5 * q_l_kc * 1e-6)
        else:
            q_l.append((0.5 * q_l_kc * 1e-6) / (D_otn[i] ** 2))
    return q_l
def find_q_sum(q_kon, q_l):
    """
    –°—É–º–º–∏—Ä—É–µ—Ç –∫–æ–Ω–≤–µ–∫—Ç–∏–≤–Ω—ã–π –∏ –ª—É—á–∏—Å—Ç—ã–π —Ç–µ–ø–ª–æ–≤—ã–µ –ø–æ—Ç–æ–∫–∏ –ø–æ –∫–∞–∂–¥–æ–º—É —Å–µ—á–µ–Ω–∏—é.

    Args:
        q_kon (list of float): –ö–æ–Ω–≤–µ–∫—Ç–∏–≤–Ω—ã–µ —Ç–µ–ø–ª–æ–≤—ã–µ –ø–æ—Ç–æ–∫–∏.
        q_l (list of float): –õ—É—á–∏—Å—Ç—ã–µ —Ç–µ–ø–ª–æ–≤—ã–µ –ø–æ—Ç–æ–∫–∏.

    Returns:
        list of float: –°—É–º–º–∞—Ä–Ω—ã–µ —Ç–µ–ø–ª–æ–≤—ã–µ –ø–æ—Ç–æ–∫–∏ (–∫–æ–Ω–≤–µ–∫—Ü–∏—è + –∏–∑–ª—É—á–µ–Ω–∏–µ).
    """
    return [k + l for k, l in zip(q_kon, q_l)]
def find_temp_slozh_2(ind_peret,delta_S,q_sum,a,number,p_ohl,m_ohl,T_nach,name_ohl,T_aray,p_aray,C_aray):
    """
    –í—ã—á–∏—Å–ª—è–µ—Ç —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã –æ—Ö–ª–∞–¥–∏—Ç–µ–ª—è –ø—Ä–∏ —Å–ª–æ–∂–Ω–æ–π —Å–∏—Å—Ç–µ–º–µ –æ—Ö–ª–∞–∂–¥–µ–Ω–∏—è:
    –ø–æ—Ç–æ–∫ —Å–Ω–∞—á–∞–ª–∞ –¥–≤–∏–∂–µ—Ç—Å—è –∫ —Å–µ—Ä–µ–¥–∏–Ω–µ –∫–∞–Ω–∞–ª–∞, –∑–∞—Ç–µ–º –ø–æ–≤–æ—Ä–∞—á–∏–≤–∞–µ—Ç –∏ –∏–¥—ë—Ç –æ–±—Ä–∞—Ç–Ω–æ (–ø—Ä–æ—Ç–∏–≤–æ—Ç–æ–∫–æ–º).

    –ú–æ–¥–µ–ª—å –¥–µ–ª–∏—Ç –∫–∞–Ω–∞–ª –Ω–∞ –¥–≤–µ —á–∞—Å—Ç–∏:
    - –ü—Ä—è–º–∞—è —á–∞—Å—Ç—å (–æ—Ç –∫–∞–º–µ—Ä—ã –∫ —Å–µ—Ä–µ–¥–∏–Ω–µ) —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –Ω–∞–ø—Ä—è–º—É—é.
    - –û–±—Ä–∞—Ç–Ω–∞—è —á–∞—Å—Ç—å (–æ—Ç —Å–µ—Ä–µ–¥–∏–Ω—ã –∫ –≤—ã—Ö–æ–¥—É —Å–æ–ø–ª–∞) —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è —Å –Ω–∞—á–∞–ª—å–Ω–æ–π —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–æ–π,
      —Ä–∞–≤–Ω–æ–π —Ñ–∏–Ω–∞–ª—å–Ω–æ–π —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–µ –ø–µ—Ä–≤–æ–π —á–∞—Å—Ç–∏.

    Args:
        ind_peret (int): –ò–Ω–¥–µ–∫—Å —Ç–æ—á–∫–∏ —Ä–∞–∑–≤–æ—Ä–æ—Ç–∞ –ø–æ—Ç–æ–∫–∞ (—Å–µ—Ä–µ–¥–∏–Ω–∞ –∫–∞–Ω–∞–ª–∞).
        delta_S (list of float): –ü–ª–æ—â–∞–¥—å —Å–µ—á–µ–Ω–∏—è –∫–∞–Ω–∞–ª–∞ –ø–æ –¥–ª–∏–Ω–µ (–º¬≤).
        q_sum (list of float): –°—É–º–º–∞—Ä–Ω—ã–π —Ç–µ–ø–ª–æ–≤–æ–π –ø–æ—Ç–æ–∫ –Ω–∞ —É—á–∞—Å—Ç–∫–µ [–í—Ç/–º¬≤].
        a (float): –ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç —Ç–µ–ø–ª–æ–æ–±–º–µ–Ω–∞.
        number (list of int): –ò–Ω–¥–µ–∫—Å—ã —Ä–∞—Å—á—ë—Ç–Ω—ã—Ö —Ç–æ—á–µ–∫.
        p_ohl (list of float): –î–∞–≤–ª–µ–Ω–∏–µ –æ—Ö–ª–∞–¥–∏—Ç–µ–ª—è –ø–æ —É—á–∞—Å—Ç–∫–∞–º (–ü–∞).
        m_ohl (float): –ú–∞—Å—Å–æ–≤—ã–π —Ä–∞—Å—Ö–æ–¥ –æ—Ö–ª–∞–¥–∏—Ç–µ–ª—è (–∫–≥/—Å).
        T_nach (float): –ù–∞—á–∞–ª—å–Ω–∞—è —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –æ—Ö–ª–∞–¥–∏—Ç–µ–ª—è (–ö).
        name_ohl (str): –ù–∞–∑–≤–∞–Ω–∏–µ –æ—Ö–ª–∞–¥–∏—Ç–µ–ª—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, "–≤–æ–¥–æ—Ä–æ–¥", "–º–µ—Ç–∞–Ω").
        T_aray (list of float): –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–Ω—ã–π –º–∞—Å—Å–∏–≤ –¥–ª—è –∏–Ω—Ç–µ—Ä–ø–æ–ª—è—Ü–∏–∏.
        p_aray (list of float): –î–∞–≤–ª–µ–Ω–∏—è –¥–ª—è –∏–Ω—Ç–µ—Ä–ø–æ–ª—è—Ü–∏–∏ —Ç–µ–ø–ª–æ—ë–º–∫–æ—Å—Ç–∏.
        C_aray (list of float): –¢–∞–±–ª–∏—Ü–∞ —Ç–µ–ø–ª–æ—ë–º–∫–æ—Å—Ç–∏ (–ø–æ T –∏ p).

    Returns:
        tuple:
            - T_final (np.ndarray): –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã –ø–æ –≤—Å–µ–π –¥–ª–∏–Ω–µ –∫–∞–Ω–∞–ª–∞.
            - C_p_ohl_final (np.ndarray): –¢–µ–ø–ª–æ—ë–º–∫–æ—Å—Ç—å –æ—Ö–ª–∞–¥–∏—Ç–µ–ª—è –≤ –∫–∞–∂–¥–æ–π —Ç–æ—á–∫–µ.
            - C_p_raznitsa_final (np.ndarray): –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Ç–µ–ø–ª–æ—ë–º–∫–æ—Å—Ç–∏ –º–µ–∂–¥—É —Ç–æ—á–∫–∞–º–∏.

    –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:
        –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é `find_temp()` –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω–∏—è —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã –≤–¥–æ–ª—å –∫–∞–Ω–∞–ª–∞.
    """
    mid_index = ind_peret
    # --- üîπ 1. –ü–æ –ø–æ—Ç–æ–∫—É (–æ—Ç –∫–∞–º–µ—Ä—ã –∫ —Å–µ—Ä–µ–¥–∏–Ω–µ) ---
    number_part1=number[:mid_index]
    delta_S_part1 = delta_S[:mid_index]  # –û—Å—Ç–∞–≤–ª—è–µ–º –≤—Ç–æ—Ä—É—é –ø–æ–ª–æ–≤–∏–Ω—É
    p_ohl_part1 = p_ohl[:mid_index]
    q_sum_part1 = np.array(q_sum[:mid_index])  # –û—Å—Ç–∞–≤–ª—è–µ–º –≤—Ç–æ—Ä—É—é –ø–æ–ª–æ–≤–∏–Ω—É
    T_part1, C_p_ohl_part1, C_p_raznitsa_part1 = find_temp(
        number_part1, delta_S_part1, p_ohl_part1, q_sum_part1, m_ohl, a, T_nach,name_ohl,T_aray,p_aray,C_aray, reverse=False)
    T_middle = T_part1[-1]

    # --- üîπ 2. –ü—Ä–æ—Ç–∏–≤–æ—Ç–æ–∫ (–æ—Ç —Å–µ—Ä–µ–¥–∏–Ω—ã –∫ –≤—ã—Ö–æ–¥—É —Å–æ–ø–ª–∞) ---
    number_part2 = number[mid_index:]
    delta_S_part2 = delta_S[mid_index:]  # –û—Å—Ç–∞–≤–ª—è–µ–º –≤—Ç–æ—Ä—É—é –ø–æ–ª–æ–≤–∏–Ω—É
    q_sum_part2 = np.array(q_sum[mid_index:])  # –û—Å—Ç–∞–≤–ª—è–µ–º –≤—Ç–æ—Ä—É—é –ø–æ–ª–æ–≤–∏–Ω—É
    p_ohl_part2=p_ohl[mid_index:]
    T_part2, C_p_ohl_part2, C_p_raznitsa_part2 = find_temp(
        number_part2, delta_S_part2, p_ohl_part2, q_sum_part2, m_ohl, a, T_middle,name_ohl,T_aray,p_aray,C_aray, reverse=True)
    T_final = np.concatenate((T_part1, T_part2))
    C_p_ohl_final = np.concatenate((C_p_ohl_part1, C_p_ohl_part2))
    C_p_raznitsa_final = np.concatenate((C_p_raznitsa_part1, C_p_raznitsa_part2))
    print(f'–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –æ—Ö–ª–∞–¥–∏—Ç–µ–ª—è: {max(T_final)} –ö, –ø–æ–¥–æ–≥—Ä–µ–≤ —Å–æ—Å—Ç–∞–≤–ª—è–µ—Ç {max(T_final) - min(T_final):.2f}–ö')
    return T_final, C_p_ohl_final, C_p_raznitsa_final
def find_temp_slozh_1(ind_peret,delta_S,q_sum,a,number,p_ohl,m_ohl,T_nach,name_ohl,T_aray,p_aray,C_aray):
    """
    –í—ã—á–∏—Å–ª—è–µ—Ç —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã –æ—Ö–ª–∞–¥–∏—Ç–µ–ª—è –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ —Å –æ–¥–Ω–æ—Å—Ç–æ—Ä–æ–Ω–Ω–∏–º –æ—Ö–ª–∞–∂–¥–µ–Ω–∏–µ–º:
    —Å–Ω–∞—á–∞–ª–∞ –ø–æ—Ç–æ–∫ –∏–¥—ë—Ç –æ—Ç —Å–µ—Ä–µ–¥–∏–Ω—ã –∫–∞–Ω–∞–ª–∞ –∫ –≤—ã—Ö–æ–¥—É —Å–æ–ø–ª–∞, –∑–∞—Ç–µ–º ‚Äî –≤ –æ–±—Ä–∞—Ç–Ω—É—é —Å—Ç–æ—Ä–æ–Ω—É –∫ –∫–∞–º–µ—Ä–µ.

    –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –º–æ–¥–µ–ª—å –¥–≤—É—Ö —É—á–∞—Å—Ç–∫–æ–≤:
    - –ü—Ä—è–º–æ–π —É—á–∞—Å—Ç–æ–∫ (–æ—Ç —Å–µ—Ä–µ–¥–∏–Ω—ã –∫ —Å–æ–ø–ª—É) ‚Äî —Å –Ω–∞—á–∞–ª—å–Ω–æ–π —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–æ–π `T_nach`.
    - –û–±—Ä–∞—Ç–Ω—ã–π —É—á–∞—Å—Ç–æ–∫ (–æ—Ç —Å–µ—Ä–µ–¥–∏–Ω—ã –∫ –Ω–∞—á–∞–ª—É –∫–∞–Ω–∞–ª–∞) ‚Äî —Å –Ω–∞—á–∞–ª—å–Ω–æ–π —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–æ–π,
      —Ä–∞–≤–Ω–æ–π —Ñ–∏–Ω–∞–ª—å–Ω–æ–π —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–µ –ø—Ä—è–º–æ–≥–æ —É—á–∞—Å—Ç–∫–∞.

    Args:
        ind_peret (int): –ò–Ω–¥–µ–∫—Å —Ç–æ—á–∫–∏ —Ä–∞–∑–≤–æ—Ä–æ—Ç–∞ (—Å–µ—Ä–µ–¥–∏–Ω–∞ –∫–∞–Ω–∞–ª–∞).
        delta_S (list of float): –ü–ª–æ—â–∞–¥—å —Å–µ—á–µ–Ω–∏—è –∫–∞–Ω–∞–ª–∞ –ø–æ –¥–ª–∏–Ω–µ (–º¬≤).
        q_sum (list of float): –°—É–º–º–∞—Ä–Ω—ã–π —Ç–µ–ø–ª–æ–≤–æ–π –ø–æ—Ç–æ–∫ –Ω–∞ –∫–∞–∂–¥–æ–º —É—á–∞—Å—Ç–∫–µ (–í—Ç/–º¬≤).
        a (float): –ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç —Ç–µ–ø–ª–æ–æ—Ç–¥–∞—á–∏ (–í—Ç/–º¬≤¬∑–ö).
        number (list of int): –ò–Ω–¥–µ–∫—Å—ã —Ä–∞—Å—á—ë—Ç–Ω—ã—Ö —Ç–æ—á–µ–∫.
        p_ohl (list of float): –î–∞–≤–ª–µ–Ω–∏–µ –æ—Ö–ª–∞–¥–∏—Ç–µ–ª—è (–ü–∞) –Ω–∞ –∫–∞–∂–¥–æ–º —É—á–∞—Å—Ç–∫–µ.
        m_ohl (float): –ú–∞—Å—Å–æ–≤—ã–π —Ä–∞—Å—Ö–æ–¥ –æ—Ö–ª–∞–¥–∏—Ç–µ–ª—è (–∫–≥/—Å).
        T_nach (float): –ù–∞—á–∞–ª—å–Ω–∞—è —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –æ—Ö–ª–∞–¥–∏—Ç–µ–ª—è (–ö).
        name_ohl (str): –ù–∞–∑–≤–∞–Ω–∏–µ –æ—Ö–ª–∞–¥–∏—Ç–µ–ª—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, "–≤–æ–¥–æ—Ä–æ–¥", "–º–µ—Ç–∞–Ω").
        T_aray (list of float): –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã –¥–ª—è –∏–Ω—Ç–µ—Ä–ø–æ–ª—è—Ü–∏–∏ —Ç–µ–ø–ª–æ—ë–º–∫–æ—Å—Ç–∏.
        p_aray (list of float): –î–∞–≤–ª–µ–Ω–∏—è –¥–ª—è –∏–Ω—Ç–µ—Ä–ø–æ–ª—è—Ü–∏–∏ —Ç–µ–ø–ª–æ—ë–º–∫–æ—Å—Ç–∏.
        C_aray (list of float): –¢–∞–±–ª–∏—Ü–∞ —Ç–µ–ø–ª–æ—ë–º–∫–æ—Å—Ç–∏ (–ø–æ T –∏ p).

    Returns:
        tuple:
            - T_final (np.ndarray): –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –æ—Ö–ª–∞–¥–∏—Ç–µ–ª—è –≤–¥–æ–ª—å –≤—Å–µ–π –¥–ª–∏–Ω—ã –∫–∞–Ω–∞–ª–∞.
            - C_p_ohl_final (np.ndarray): –¢–µ–ø–ª–æ—ë–º–∫–æ—Å—Ç—å –æ—Ö–ª–∞–¥–∏—Ç–µ–ª—è –≤ –∫–∞–∂–¥–æ–π —Ç–æ—á–∫–µ.
            - C_p_raznitsa_final (np.ndarray): –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Ç–µ–ø–ª–æ—ë–º–∫–æ—Å—Ç–∏ –º–µ–∂–¥—É —Ç–æ—á–∫–∞–º–∏.

    –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:
        –û—Å–Ω–æ–≤–∞–Ω–∞ –Ω–∞ –≤—ã–∑–æ–≤–µ —Ñ—É–Ω–∫—Ü–∏–∏ `find_temp`, –∫–æ—Ç–æ—Ä–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç —á–∏—Å–ª–µ–Ω–Ω–æ–µ –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã.
    """
    mid_index = ind_peret
    # --- üîπ 2. –ü–æ –ø–æ—Ç–æ–∫—É (–æ—Ç —Å–µ—Ä–µ–¥–∏–Ω—ã –∫ –≤—ã—Ö–æ–¥—É —Å–æ–ø–ª–∞) ---
    delta_S_fwd = delta_S[mid_index:]  # –û—Å—Ç–∞–≤–ª—è–µ–º –ø–µ—Ä–≤—É—é –ø–æ–ª–æ–≤–∏–Ω—É
    q_sum_fwd = np.array(q_sum[mid_index:])  # –ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º

    T_part2, C_p_ohl_part2, C_p_raznitsa_part2 = find_temp(
        number[mid_index:], delta_S_fwd, p_ohl[mid_index:], q_sum_fwd, m_ohl, a, T_nach,name_ohl,T_aray,p_aray,C_aray, reverse=False)
    T_middle = T_part2[-1]
    # --- üîπ 1. –ü—Ä–æ—Ç–∏–≤–æ—Ç–æ–∫ (–æ—Ç —Å–µ—Ä–µ–¥–∏–Ω—ã –∫ –Ω–∞—á–∞–ª—É —Å–æ–ø–ª–∞) ---
    T_part1, C_p_ohl_part1, C_p_raznitsa_part1 = find_temp(
        number[:mid_index], delta_S[:mid_index], p_ohl[:mid_index], q_sum[:mid_index], m_ohl, a, T_middle,name_ohl,T_aray,p_aray,C_aray, reverse=True)
    # –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –≤ —Å–µ—Ä–µ–¥–∏–Ω–µ —Å–æ–ø–ª–∞ –ø–æ—Å–ª–µ –ø–µ—Ä–≤–æ–π —Å—Ç–∞–¥–∏–∏
    # –û–±—ä–µ–¥–∏–Ω—è–µ–º –¥–≤–∞ —É—á–∞—Å—Ç–∫–∞ –≤ –æ–¥–∏–Ω –º–∞—Å—Å–∏–≤
    T_final = np.concatenate((T_part1, T_part2))
    C_p_ohl_final = np.concatenate((C_p_ohl_part1, C_p_ohl_part2))
    C_p_raznitsa_final = np.concatenate((C_p_raznitsa_part1, C_p_raznitsa_part2))

    print(f'–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –æ—Ö–ª–∞–¥–∏—Ç–µ–ª—è: {max(T_final)} –ö, –ø–æ–¥–æ–≥—Ä–µ–≤ —Å–æ—Å—Ç–∞–≤–ª—è–µ—Ç {max(T_final) - min(T_final):.2f}–ö')
    return T_final, C_p_ohl_final, C_p_raznitsa_final
def find_temp_slozh_5(m_ohl_1,m_ohl_2,index_peret_1,index_peret_2,delta_S,q_sum,number,p_ohl,a,T_nach,name_ohl,T_aray,p_aray,C_aray):
    """
    –í—ã—á–∏—Å–ª—è–µ—Ç —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã –æ—Ö–ª–∞–¥–∏—Ç–µ–ª—è –ø—Ä–∏ —Å–ª–æ–∂–Ω–æ–π —Å—Ö–µ–º–µ –æ—Ö–ª–∞–∂–¥–µ–Ω–∏—è —Å –¥–≤—É–º—è –ø–æ—Ç–æ–∫–∞–º–∏:
    –æ–¥–∏–Ω ‚Äî –ø—Ä—è–º–æ—Ç–æ—á–Ω—ã–π (–æ—Ç —Å–µ—Ä–µ–¥–∏–Ω—ã –∫ –≤—ã—Ö–æ–¥—É —Å–æ–ø–ª–∞), –≤—Ç–æ—Ä–æ–π ‚Äî –ø—Ä–æ—Ç–∏–≤–æ—Ç–æ—á–Ω—ã–π (–æ—Ç —Å–æ–ø–ª–∞ –∫ –∫–∞–º–µ—Ä–µ).
    –ü–æ—Ç–æ–∫–∏ –∏–º–µ—é—Ç —Ä–∞–∑–Ω—ã–µ –º–∞—Å—Å–æ–≤—ã–µ —Ä–∞—Å—Ö–æ–¥—ã.

    –°—Ç—Ä—É–∫—Ç—É—Ä–∞:
    üîπ –ß–∞—Å—Ç—å 1: –ü—Ä–æ—Ç–∏–≤–æ—Ç–æ–∫ –æ—Ç `index_peret_2` –∫ –Ω–∞—á–∞–ª—É –∫–∞–Ω–∞–ª–∞ ‚Äî —Å –º–∞—Å—Å–æ–≤—ã–º —Ä–∞—Å—Ö–æ–¥–æ–º `m_ohl_2`.
    üîπ –ß–∞—Å—Ç—å 2: –ü—Ä—è–º–æ—Ç–æ–∫ –æ—Ç `index_peret_2` –∫ –≤—ã—Ö–æ–¥—É —Å–æ–ø–ª–∞ ‚Äî —Å –º–∞—Å—Å–æ–≤—ã–º —Ä–∞—Å—Ö–æ–¥–æ–º `m_ohl_1`.

    Args:
        m_ohl_1 (float): –ú–∞—Å—Å–æ–≤—ã–π —Ä–∞—Å—Ö–æ–¥ –≤ –ø—Ä—è–º–æ—Ç–æ—á–Ω–æ–º —É—á–∞—Å—Ç–∫–µ (–∫ —Å–æ–ø–ª—É), –∫–≥/—Å.
        m_ohl_2 (float): –ú–∞—Å—Å–æ–≤—ã–π —Ä–∞—Å—Ö–æ–¥ –≤ –ø—Ä–æ—Ç–∏–≤–æ—Ç–æ—á–Ω–æ–º —É—á–∞—Å—Ç–∫–µ (–∫ –∫–∞–º–µ—Ä–µ), –∫–≥/—Å.
        index_peret_1 (int): –ò–Ω–¥–µ–∫—Å —Ä–∞–∑–≤–æ—Ä–æ—Ç–∞ –ø—Ä—è–º–æ—Ç–æ–∫–∞ (–Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ —ç—Ç–æ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏).
        index_peret_2 (int): –ò–Ω–¥–µ–∫—Å —Ä–∞–∑–≤–æ—Ä–æ—Ç–∞ –ø—Ä–æ—Ç–∏–≤–æ—Ç–æ–∫–∞ –∏ –Ω–∞—á–∞–ª–∞ –ø—Ä—è–º–æ—Ç–æ–∫–∞.
        delta_S (list of float): –ü–ª–æ—â–∞–¥–∏ —Å–µ—á–µ–Ω–∏—è –∫–∞–Ω–∞–ª–∞ –≤–¥–æ–ª—å –¥–ª–∏–Ω—ã (–º¬≤).
        q_sum (list of float): –°—É–º–º–∞—Ä–Ω—ã–π —Ç–µ–ø–ª–æ–≤–æ–π –ø–æ—Ç–æ–∫ –Ω–∞ —É—á–∞—Å—Ç–∫–µ (–í—Ç/–º¬≤).
        number (list of int): –ò–Ω–¥–µ–∫—Å—ã —Ä–∞—Å—á—ë—Ç–Ω—ã—Ö —Ç–æ—á–µ–∫.
        p_ohl (list of float): –î–∞–≤–ª–µ–Ω–∏–µ –æ—Ö–ª–∞–¥–∏—Ç–µ–ª—è (–ü–∞).
        a (float): –ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç —Ç–µ–ø–ª–æ–æ—Ç–¥–∞—á–∏ (–í—Ç/–º¬≤¬∑–ö).
        T_nach (float): –ù–∞—á–∞–ª—å–Ω–∞—è —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –æ—Ö–ª–∞–¥–∏—Ç–µ–ª—è (–ö).
        name_ohl (str): –ù–∞–∑–≤–∞–Ω–∏–µ –æ—Ö–ª–∞–¥–∏—Ç–µ–ª—è.
        T_aray (list of float): –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã –¥–ª—è –∏–Ω—Ç–µ—Ä–ø–æ–ª—è—Ü–∏–∏ —Ç–µ–ø–ª–æ—ë–º–∫–æ—Å—Ç–∏.
        p_aray (list of float): –î–∞–≤–ª–µ–Ω–∏—è –¥–ª—è –∏–Ω—Ç–µ—Ä–ø–æ–ª—è—Ü–∏–∏ —Ç–µ–ø–ª–æ—ë–º–∫–æ—Å—Ç–∏.
        C_aray (list of float): –¢–∞–±–ª–∏—Ü–∞ —Ç–µ–ø–ª–æ—ë–º–∫–æ—Å—Ç–∏ –ø–æ T –∏ p.

    Returns:
        tuple:
            - T_final (np.ndarray): –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–Ω—ã–π –ø—Ä–æ—Ñ–∏–ª—å –æ—Ö–ª–∞–¥–∏—Ç–µ–ª—è.
            - C_p_ohl_final (np.ndarray): –¢–µ–ø–ª–æ—ë–º–∫–æ—Å—Ç—å –æ—Ö–ª–∞–¥–∏—Ç–µ–ª—è –≤ –∫–∞–∂–¥–æ–π —Ç–æ—á–∫–µ.
            - C_p_raznitsa_final (np.ndarray): –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Ç–µ–ø–ª–æ—ë–º–∫–æ—Å—Ç–∏ –º–µ–∂–¥—É —Ç–æ—á–∫–∞–º–∏.
            - m_final (np.ndarray): –ú–∞—Å—Å–∏–≤ –º–∞—Å—Å–æ–≤—ã—Ö —Ä–∞—Å—Ö–æ–¥–æ–≤ –≤–¥–æ–ª—å –∫–∞–Ω–∞–ª–∞.
    """
    T_nach_0 = T_nach
    # --- üîπ 1. –ü—Ä–æ—Ç–∏–≤–æ—Ç–æ–∫ (–æ—Ç index_peret_2 –∫ –∫–∞–º–µ—Ä–µ) ---
    T_part2, C_p_ohl_part2, C_p_raznitsa_part2 = find_temp(number[:index_peret_2],
                                                           delta_S[:index_peret_2],
                                                           p_ohl[:index_peret_2],
                                                           q_sum[:index_peret_2], m_ohl_2, a, T_nach,
                                                           name_ohl, T_aray, p_aray, C_aray, reverse=True)
    T_middle_2 = T_part2[0]
    m_ohl_array_2 = [m_ohl_2] * len(T_part2)
    # --- üîπ 2. –ü–æ –ø–æ—Ç–æ–∫—É (–æ—Ç index_peret_2 –∫ –∫–æ–Ω—Ü—É –∑–µ—Ä–∫–∞–ª—å–Ω–æ–π —á–∞—Å—Ç–∏) --
    delta_S_fwd = delta_S[index_peret_2:]  # –û—Å—Ç–∞–≤–ª—è–µ–º –ø–µ—Ä–≤—É—é –ø–æ–ª–æ–≤–∏–Ω—É
    m_ohl_array_1 = [m_ohl_1] * len(delta_S_fwd)
    q_sum_fwd = np.array(q_sum[index_peret_2:])  # –ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º
    T_part1, C_p_ohl_part1, C_p_raznitsa_part1 = find_temp(number[index_peret_2:], delta_S_fwd, p_ohl[index_peret_2:],
                                                           q_sum_fwd, m_ohl_1, a, T_nach_0, name_ohl, T_aray, p_aray,
                                                           C_aray, reverse=False)

    T_final = np.concatenate((T_part2, T_part1))
    m_final = np.concatenate((m_ohl_array_2, m_ohl_array_1))
    C_p_ohl_final = np.concatenate((C_p_ohl_part2, C_p_ohl_part1))
    C_p_raznitsa_final = np.concatenate((C_p_raznitsa_part2, C_p_raznitsa_part1))
    print(f'–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –æ—Ö–ª–∞–¥–∏—Ç–µ–ª—è: {max(T_final)} –ö, –ø–æ–¥–æ–≥—Ä–µ–≤ —Å–æ—Å—Ç–∞–≤–ª—è–µ—Ç {max(T_final) - min(T_final):.2f}–ö')
    return T_final, C_p_ohl_final, C_p_raznitsa_final,m_final
def find_temp_slosh_tema(m_ohl_1,m_ohl_2,index_peret_1,index_peret_2,delta_S,q_sum,number,p_ohl,a,T_nach,name_ohl,T_aray,p_aray,C_aray):
    """
    –ú–æ–¥–µ–ª—å —Ä–∞—Å—á—ë—Ç–∞ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã –æ—Ö–ª–∞–¥–∏—Ç–µ–ª—è –¥–ª—è —Ç—Ä—ë—Ö–ø–æ—Ç–æ—á–Ω–æ–π —Å—Ö–µ–º—ã:
    ‚ñ∏ –ü—Ä—è–º–æ—Ç–æ–∫ –æ—Ç —Ä–∞–∑–≤–æ—Ä–æ—Ç–∞ 1 –∫ —Å–æ–ø–ª—É,
    ‚ñ∏ –ü—Ä–æ—Ç–∏–≤–æ—Ç–æ–∫ –æ—Ç —Ä–∞–∑–≤–æ—Ä–æ—Ç–∞ 2 –∫ —Ä–∞–∑–≤–æ—Ä–æ—Ç—É 1,
    ‚ñ∏ –°—É–º–º–∞—Ä–Ω—ã–π –ø—Ä–æ—Ç–∏–≤–æ—Ç–æ–∫ –æ—Ç –∫–∞–º–µ—Ä—ã –¥–æ —Ä–∞–∑–≤–æ—Ä–æ—Ç–∞ 2, –≥–¥–µ –¥–≤–∞ –ø–æ—Ç–æ–∫–∞ –æ–±—ä–µ–¥–∏–Ω—è—é—Ç—Å—è.

    –°–Ω–∞—á–∞–ª–∞ —Å—á–∏—Ç–∞–µ—Ç—Å—è —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –≤ –¥–≤—É—Ö –ø–æ—Ç–æ–∫–∞—Ö –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ, –∑–∞—Ç–µ–º —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è
    —Ä–µ–∑—É–ª—å—Ç–∏—Ä—É—é—â–∏–π –æ–±—ä–µ–¥–∏–Ω—ë–Ω–Ω—ã–π –ø–æ—Ç–æ–∫ —Å —É—á—ë—Ç–æ–º —ç–Ω—Ç–∞–ª—å–ø–∏–π–Ω–æ–π —Ä–∞–≤–Ω–æ–≤–µ—Å–Ω–æ–π —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã.

    Args:
        m_ohl_1 (float): –ú–∞—Å—Å–æ–≤—ã–π —Ä–∞—Å—Ö–æ–¥ –æ—Ö–ª–∞–¥–∏—Ç–µ–ª—è –≤ –ø–µ—Ä–≤–æ–º (–ø—Ä—è–º–æ—Ç–æ—á–Ω–æ–º) –ø–æ—Ç–æ–∫–µ [–∫–≥/—Å].
        m_ohl_2 (float): –ú–∞—Å—Å–æ–≤—ã–π —Ä–∞—Å—Ö–æ–¥ –≤–æ –≤—Ç–æ—Ä–æ–º (–ø—Ä–æ—Ç–∏–≤–æ—Ç–æ—á–Ω–æ–º) –ø–æ—Ç–æ–∫–µ [–∫–≥/—Å].
        index_peret_1 (int): –ò–Ω–¥–µ–∫—Å —Ç–æ—á–∫–∏ –ø–æ–≤–æ—Ä–æ—Ç–∞ –ø–µ—Ä–≤–æ–≥–æ –ø–æ—Ç–æ–∫–∞ (–ø—Ä—è–º–æ—Ç–æ–∫).
        index_peret_2 (int): –ò–Ω–¥–µ–∫—Å —Ç–æ—á–∫–∏ –ø–æ–≤–æ—Ä–æ—Ç–∞ –≤—Ç–æ—Ä–æ–≥–æ –ø–æ—Ç–æ–∫–∞ (–ø—Ä–æ—Ç–∏–≤–æ—Ç–æ–∫).
        delta_S (list of float): –ü–ª–æ—â–∞–¥–∏ –∫–∞–Ω–∞–ª–æ–≤ –≤–¥–æ–ª—å –¥–ª–∏–Ω—ã (–º¬≤).
        q_sum (list of float): –°—É–º–º–∞—Ä–Ω—ã–π —Ç–µ–ø–ª–æ–≤–æ–π –ø–æ—Ç–æ–∫ –≤ –∫–∞–∂–¥–æ–π —Ç–æ—á–∫–µ [–í—Ç/–º¬≤].
        number (list of int): –ò–Ω–¥–µ–∫—Å—ã —Ä–∞—Å—á—ë—Ç–Ω—ã—Ö —Ç–æ—á–µ–∫.
        p_ohl (list of float): –î–∞–≤–ª–µ–Ω–∏–µ –æ—Ö–ª–∞–¥–∏—Ç–µ–ª—è –≤ –∫–∞–∂–¥–æ–π —Ç–æ—á–∫–µ [–ü–∞].
        a (float): –ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç —Ç–µ–ø–ª–æ–æ—Ç–¥–∞—á–∏ (–í—Ç/–º¬≤¬∑–ö).
        T_nach (float): –ù–∞—á–∞–ª—å–Ω–∞—è —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –æ—Ö–ª–∞–¥–∏—Ç–µ–ª—è (–ö).
        name_ohl (str): –ù–∞–∑–≤–∞–Ω–∏–µ –æ—Ö–ª–∞–¥–∏—Ç–µ–ª—è (–Ω–∞–ø—Ä. "–º–µ—Ç–∞–Ω", "–≤–æ–¥–æ—Ä–æ–¥").
        T_aray (list of float): –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–Ω—ã–π –º–∞—Å—Å–∏–≤ –¥–ª—è –∏–Ω—Ç–µ—Ä–ø–æ–ª—è—Ü–∏–∏.
        p_aray (list of float): –î–∞–≤–ª–µ–Ω–∏—è –¥–ª—è –∏–Ω—Ç–µ—Ä–ø–æ–ª—è—Ü–∏–∏ —Ç–µ–ø–ª–æ—ë–º–∫–æ—Å—Ç–∏.
        C_aray (list of float): –¢–∞–±–ª–∏—Ü–∞ –∑–Ω–∞—á–µ–Ω–∏–π —Ç–µ–ø–ª–æ—ë–º–∫–æ—Å—Ç–∏ (–ø–æ T –∏ p).

    Returns:
        tuple:
            - T_final (np.ndarray): –ü–æ–ª–Ω—ã–π —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–Ω—ã–π –ø—Ä–æ—Ñ–∏–ª—å –ø–æ –≤—Å–µ–π –¥–ª–∏–Ω–µ –∫–∞–Ω–∞–ª–∞.
            - C_p_ohl_final (np.ndarray): –¢–µ–ø–ª–æ—ë–º–∫–æ—Å—Ç—å –æ—Ö–ª–∞–¥–∏—Ç–µ–ª—è –≤ –∫–∞–∂–¥–æ–π —Ç–æ—á–∫–µ.
            - C_p_raznitsa_final (np.ndarray): –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Ç–µ–ø–ª–æ—ë–º–∫–æ—Å—Ç–∏ –º–µ–∂–¥—É —Ç–æ—á–∫–∞–º–∏.
            - m_final (np.ndarray): –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –º–∞—Å—Å–æ–≤–æ–≥–æ —Ä–∞—Å—Ö–æ–¥–∞ –≤–¥–æ–ª—å –¥–ª–∏–Ω—ã –∫–∞–Ω–∞–ª–∞.
    """
    T_nach_0=T_nach
    # --- üîπ 1. –ü–æ –ø–æ—Ç–æ–∫—É (–æ—Ç index_peret_1 –∫ –≤—ã—Ö–æ–¥—É —Å–æ–ø–ª–∞) --
    delta_S_fwd = delta_S[index_peret_1:]  # –û—Å—Ç–∞–≤–ª—è–µ–º –ø–µ—Ä–≤—É—é –ø–æ–ª–æ–≤–∏–Ω—É
    m_ohl_array_1=[m_ohl_1]*len(delta_S_fwd)
    q_sum_fwd = np.array(q_sum[index_peret_1:])  # –ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º
    T_part1, C_p_ohl_part1, C_p_raznitsa_part1 = find_temp(number[index_peret_1:], delta_S_fwd, p_ohl[index_peret_1:], q_sum_fwd, m_ohl_1, a, T_nach,name_ohl,T_aray,p_aray,C_aray, reverse=False)
    T_middle = T_part1[-1]

    # --- üîπ 2. –ü—Ä–æ—Ç–∏–≤–æ—Ç–æ–∫ (–æ—Ç index_peret_2 –∫ index_peret_1) ---
    T_part2, C_p_ohl_part2, C_p_raznitsa_part2 = find_temp(number[index_peret_2:index_peret_1], delta_S[index_peret_2:index_peret_1], p_ohl[index_peret_2:index_peret_1], q_sum[index_peret_2:index_peret_1], m_ohl_2, a, T_nach,name_ohl,T_aray,p_aray,C_aray, reverse=True)
    T_middle_2 = T_part2[0]
    m_ohl_array_2 = [m_ohl_2] * len(T_part2)
    # --- üîπ 3. –°—É–º–º–∞—Ä–Ω—ã–π –ø—Ä–æ—Ç–∏–≤–æ–ø–æ—Ç–æ–∫ (–æ—Ç –∫–∞–º–µ—Ä—ã –∫ index_peret_2) ---
    T_nach_1=((m_ohl_1*T_middle)+(m_ohl_2*T_middle_2))/(m_ohl_1+m_ohl_2)
    T_part3, C_p_ohl_part3, C_p_raznitsa_part3 = find_temp(number[:index_peret_2],
                                                           delta_S[:index_peret_2], p_ohl[:index_peret_2],
                                                           q_sum[:index_peret_2], m_ohl_2+m_ohl_1, a, T_nach_1,name_ohl,T_aray,p_aray,C_aray,
                                                           reverse=True)
    T_middle_3 = T_part3[-1]
    m_ohl_array_3 = [m_ohl_1+m_ohl_2] * len(T_part3)
    print(f'–†–∞—Å—á—ë—Ç –ø—Ä–æ—Ç–∏–≤–æ—Ç–æ–∫–∞ –∑–∞–≤–µ—Ä—à—ë–Ω!')
    T_final = np.concatenate((T_part3, T_part2,T_part1))
    m_final=np.concatenate((m_ohl_array_3, m_ohl_array_2,m_ohl_array_1))
    C_p_ohl_final = np.concatenate((C_p_ohl_part3, C_p_ohl_part2,C_p_ohl_part1))
    C_p_raznitsa_final = np.concatenate((C_p_raznitsa_part3, C_p_raznitsa_part2,C_p_raznitsa_part1))
    print(f'–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –æ—Ö–ª–∞–¥–∏—Ç–µ–ª—è: {max(T_final)} –ö, –ø–æ–¥–æ–≥—Ä–µ–≤ —Å–æ—Å—Ç–∞–≤–ª—è–µ—Ç {max(T_final) - min(T_final):.2f}–ö')
    return T_final, C_p_ohl_final, C_p_raznitsa_final,m_final
def find_temp_slozh_6(m_ohl_1,m_ohl_2,index_peret,delta_S,q_sum,number,p_ohl,a,T_nach_1,T_nach_2,T_aray_1,p_aray_1,C_aray_1,T_aray_2,p_aray_2,C_aray_2):
    """
    –†–∞—Å—á—ë—Ç —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã –æ—Ö–ª–∞–¥–∏—Ç–µ–ª—è –ø—Ä–∏ –¥–≤—É—Ö –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã—Ö –ø—Ä–æ—Ç–∏–≤–æ—Ç–æ—á–Ω—ã—Ö –ø–æ—Ç–æ–∫–∞—Ö:
    ‚ñ∏ –ü–µ—Ä–≤—ã–π –ø–æ—Ç–æ–∫ (–ê–¢) –∏–¥—ë—Ç –æ—Ç —Ç–æ—á–∫–∏ —Ä–∞–∑–≤–æ—Ä–æ—Ç–∞ `index_peret` –∫ —Å–æ–ø–ª—É,
    ‚ñ∏ –í—Ç–æ—Ä–æ–π –ø–æ—Ç–æ–∫ (–ù–î–ú–ì) ‚Äî –æ—Ç –∫–∞–º–µ—Ä—ã –¥–æ —Ç–æ—á–∫–∏ `index_peret`.

    –ö–∞–∂–¥—ã–π –ø–æ—Ç–æ–∫ –∏–º–µ–µ—Ç —Å–≤–æ–π –º–∞—Å—Å–æ–≤—ã–π —Ä–∞—Å—Ö–æ–¥, –Ω–∞—á–∞–ª—å–Ω—É—é —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—É –∏ –Ω–∞–±–æ—Ä —Ç–µ—Ä–º–æ–¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö.

    Args:
        m_ohl_1 (float): –ú–∞—Å—Å–æ–≤—ã–π —Ä–∞—Å—Ö–æ–¥ –ø–µ—Ä–≤–æ–≥–æ –æ—Ö–ª–∞–¥–∏—Ç–µ–ª—è (–ê–¢), –∫–≥/—Å.
        m_ohl_2 (float): –ú–∞—Å—Å–æ–≤—ã–π —Ä–∞—Å—Ö–æ–¥ –≤—Ç–æ—Ä–æ–≥–æ –æ—Ö–ª–∞–¥–∏—Ç–µ–ª—è (–ù–î–ú–ì), –∫–≥/—Å.
        index_peret (int): –ò–Ω–¥–µ–∫—Å —Ç–æ—á–∫–∏ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è –ø–æ—Ç–æ–∫–æ–≤.
        delta_S (list of float): –ü–ª–æ—â–∞–¥–∏ —Å–µ—á–µ–Ω–∏—è –ø–æ –¥–ª–∏–Ω–µ –∫–∞–Ω–∞–ª–∞ (–º¬≤).
        q_sum (list of float): –°—É–º–º–∞—Ä–Ω—ã–π —Ç–µ–ø–ª–æ–≤–æ–π –ø–æ—Ç–æ–∫ –Ω–∞ —É—á–∞—Å—Ç–∫–µ (–í—Ç/–º¬≤).
        number (list of int): –ò–Ω–¥–µ–∫—Å—ã —Ä–∞—Å—á—ë—Ç–Ω—ã—Ö —Ç–æ—á–µ–∫.
        p_ohl (list of float): –î–∞–≤–ª–µ–Ω–∏–µ –æ—Ö–ª–∞–¥–∏—Ç–µ–ª—è (–ü–∞) –ø–æ —É—á–∞—Å—Ç–∫–∞–º.
        a (float): –ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç —Ç–µ–ø–ª–æ–æ—Ç–¥–∞—á–∏ (–í—Ç/–º¬≤¬∑–ö).
        T_nach_1 (float): –ù–∞—á–∞–ª—å–Ω–∞—è —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –ø–æ—Ç–æ–∫–∞ –ê–¢ (–ö).
        T_nach_2 (float): –ù–∞—á–∞–ª—å–Ω–∞—è —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –ø–æ—Ç–æ–∫–∞ –ù–î–ú–ì (–ö).
        T_aray_1 (list of float): –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã –¥–ª—è –∏–Ω—Ç–µ—Ä–ø–æ–ª—è—Ü–∏–∏ —Ç–µ–ø–ª–æ—ë–º–∫–æ—Å—Ç–∏ –ê–¢.
        p_aray_1 (list of float): –î–∞–≤–ª–µ–Ω–∏—è –¥–ª—è –∏–Ω—Ç–µ—Ä–ø–æ–ª—è—Ü–∏–∏ —Ç–µ–ø–ª–æ—ë–º–∫–æ—Å—Ç–∏ –ê–¢.
        C_aray_1 (list of float): –¢–∞–±–ª–∏—Ü–∞ —Ç–µ–ø–ª–æ—ë–º–∫–æ—Å—Ç–∏ –ê–¢ (–ø–æ T –∏ p).
        T_aray_2 (list of float): –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã –¥–ª—è –∏–Ω—Ç–µ—Ä–ø–æ–ª—è—Ü–∏–∏ —Ç–µ–ø–ª–æ—ë–º–∫–æ—Å—Ç–∏ –ù–î–ú–ì.
        p_aray_2 (list of float): –î–∞–≤–ª–µ–Ω–∏—è –¥–ª—è –∏–Ω—Ç–µ—Ä–ø–æ–ª—è—Ü–∏–∏ —Ç–µ–ø–ª–æ—ë–º–∫–æ—Å—Ç–∏ –ù–î–ú–ì.
        C_aray_2 (list of float): –¢–∞–±–ª–∏—Ü–∞ —Ç–µ–ø–ª–æ—ë–º–∫–æ—Å—Ç–∏ –ù–î–ú–ì (–ø–æ T –∏ p).

    Returns:
        tuple:
            - T_final (np.ndarray): –ü–æ–ª–Ω—ã–π —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–Ω—ã–π –ø—Ä–æ—Ñ–∏–ª—å –ø–æ –¥–ª–∏–Ω–µ –∫–∞–Ω–∞–ª–∞.
            - C_p_ohl_final (np.ndarray): –¢–µ–ø–ª–æ—ë–º–∫–æ—Å—Ç—å –æ—Ö–ª–∞–¥–∏—Ç–µ–ª—è –≤ –∫–∞–∂–¥–æ–π —Ç–æ—á–∫–µ.
            - C_p_raznitsa_final (np.ndarray): –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Ç–µ–ø–ª–æ—ë–º–∫–æ—Å—Ç–∏ –º–µ–∂–¥—É —Ç–æ—á–∫–∞–º–∏.
            - m_final (np.ndarray): –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –º–∞—Å—Å–æ–≤–æ–≥–æ —Ä–∞—Å—Ö–æ–¥–∞ –≤–¥–æ–ª—å –∫–∞–Ω–∞–ª–∞.
    """
    # --- üîπ 1. –ü—Ä–æ—Ç–∏–≤–æ—Ç–æ–∫ (–æ—Ç index_peret –∫ —Å–æ–ø–ª—É) ---
    T_part1, C_p_ohl_part1, C_p_raznitsa_part1 = find_temp(number[index_peret:],
                                                           delta_S[index_peret:],
                                                           p_ohl[index_peret:],
                                                           q_sum[index_peret:], m_ohl_1, a, T_nach_1,
                                                           '–ê–¢', T_aray_1, p_aray_1, C_aray_1, reverse=True)
    m_ohl_array_1 = [m_ohl_1] * len(T_part1)
    # --- üîπ 2. –ü—Ä–æ—Ç–∏–≤–æ—Ç–æ–∫ (–æ—Ç –∫–∞–º–µ—Ä—ã –∫ index_peret) ---
    T_part2, C_p_ohl_part2, C_p_raznitsa_part2 = find_temp(number[:index_peret],
                                                           delta_S[:index_peret],
                                                           p_ohl[:index_peret],
                                                           q_sum[:index_peret], m_ohl_2, a, T_nach_2,
                                                           '–ù–î–ú–ì', T_aray_2, p_aray_2, C_aray_2, reverse=True)
    m_ohl_array_2=[m_ohl_2]*len(T_part2)
    T_final = np.concatenate((T_part2, T_part1))
    m_final = np.concatenate((m_ohl_array_2, m_ohl_array_1))
    C_p_ohl_final = np.concatenate((C_p_ohl_part2, C_p_ohl_part1))
    C_p_raznitsa_final = np.concatenate((C_p_raznitsa_part2, C_p_raznitsa_part1))
    print(f'–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –æ—Ö–ª–∞–¥–∏—Ç–µ–ª—è: {max(T_final)} –ö, –ø–æ–¥–æ–≥—Ä–µ–≤ —Å–æ—Å—Ç–∞–≤–ª—è–µ—Ç {max(T_final) - min(T_final):.2f}–ö')
    return T_final, C_p_ohl_final, C_p_raznitsa_final, m_final
def find_temp(number, delta_S, p_ohl, q_sum, m_ohl, a, T_nach,name_ohl, T_aray, p_aray, C_aray, reverse=True, max_iter=100, verbose=False):
    """
    –ß–∏—Å–ª–µ–Ω–Ω–æ —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–Ω—ã–π –ø—Ä–æ—Ñ–∏–ª—å –æ—Ö–ª–∞–¥–∏—Ç–µ–ª—è –≤–¥–æ–ª—å –∫–∞–Ω–∞–ª–∞ —Å —É—á—ë—Ç–æ–º —Ç–µ–ø–ª–æ–æ–±–º–µ–Ω–∞ –∏ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π —Ç–µ–ø–ª–æ—ë–º–∫–æ—Å—Ç–∏.

    Args:
        number (list of int): –ò–Ω–¥–µ–∫—Å—ã —Ä–∞—Å—á—ë—Ç–Ω—ã—Ö —Å–µ—á–µ–Ω–∏–π.
        delta_S (list of float): –ü–ª–æ—â–∞–¥–∏ –ø–æ–ø–µ—Ä–µ—á–Ω–æ–≥–æ —Å–µ—á–µ–Ω–∏—è (–º¬≤).
        p_ohl (list of float): –î–∞–≤–ª–µ–Ω–∏–µ –æ—Ö–ª–∞–¥–∏—Ç–µ–ª—è (–ü–∞).
        q_sum (list of float): –°—É–º–º–∞—Ä–Ω—ã–π —Ç–µ–ø–ª–æ–≤–æ–π –ø–æ—Ç–æ–∫ (–í—Ç/–º¬≤).
        m_ohl (float): –ú–∞—Å—Å–æ–≤—ã–π —Ä–∞—Å—Ö–æ–¥ –æ—Ö–ª–∞–¥–∏—Ç–µ–ª—è (–∫–≥/—Å).
        a (float): –ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç —Ç–µ–ø–ª–æ–æ—Ç–¥–∞—á–∏ (–í—Ç/–º¬≤¬∑–ö).
        T_nach (float): –ù–∞—á–∞–ª—å–Ω–∞—è —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –æ—Ö–ª–∞–¥–∏—Ç–µ–ª—è (–ö).
        name_ohl (str): –ù–∞–∑–≤–∞–Ω–∏–µ –æ—Ö–ª–∞–¥–∏—Ç–µ–ª—è (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –ø–æ–¥–±–æ—Ä–∞ Cp).
        T_aray (list): –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–Ω—ã–π –º–∞—Å—Å–∏–≤.
        p_aray (list): –î–∞–≤–ª–µ–Ω–∏—è.
        C_aray (list): –¢–∞–±–ª–∏—Ü–∞ —Ç–µ–ø–ª–æ—ë–º–∫–æ—Å—Ç–∏ Cp(T, p).
        reverse (bool): –ù–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–∞—Å—á—ë—Ç–∞ (True ‚Äî –æ—Ç –≤—ã—Ö–æ–¥–∞ –∫ –∫–∞–º–µ—Ä–µ).
        max_iter (int): –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ —á–∏—Å–ª–æ –∏—Ç–µ—Ä–∞—Ü–∏–π –Ω–∞ –æ–¥–Ω—É —Ç–æ—á–∫—É.
        verbose (bool): –ü–µ—á–∞—Ç–∞—Ç—å –æ—Ç–ª–∞–¥–æ—á–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é.

    Returns:
        tuple:
            T (list of float): –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–Ω—ã–π –ø—Ä–æ—Ñ–∏–ª—å.
            C_p_ohl (list of float): Cp –æ—Ö–ª–∞–¥–∏—Ç–µ–ª—è.
            C_p_raznitsa (list of float): –û—à–∏–±–∫–∞ –º–µ–∂–¥—É –ø—Ä–∏–±–ª–∏–∂–µ–Ω–∏—è–º–∏.
    """
    if reverse:
        number = number[::-1]
        delta_S = delta_S[::-1][1:]
        q_sum = q_sum[::-1]

    T = [T_nach] + [0] * (len(number) - 1)
    C_p_ohl = [0] * len(number)
    C_p_raznitsa = [0] * len(number)

    q_sum = np.array(q_sum) * a

    for i in range(1, len(number)):
        delta_T_step = 1.0
        for iteration in range(max_iter):
            T_sr_1 = T[i - 1] + 0.5 * delta_T_step
            Cp_1 = interpolate_C(T_sr_1, p_ohl[i - 1], name_ohl, T_aray, p_aray, C_aray)

            delta_T_2 = 0.5 * (q_sum[i - 1] + q_sum[i]) * 1e6 * delta_S[i - 1] / (m_ohl * Cp_1)

            T_sr_2 = T[i - 1] + 0.5 * delta_T_2
            Cp_2 = interpolate_C(T_sr_2, p_ohl[i - 1], name_ohl, T_aray, p_aray, C_aray)

            diff = abs(Cp_2 - Cp_1) * 100 / Cp_1
            if diff <= 5:
                T[i] = T[i - 1] + delta_T_2
                C_p_ohl[i] = Cp_2
                C_p_raznitsa[i] = diff
                break
            delta_T_step += 1

            if iteration == max_iter - 1 and verbose:
                print(f"[WARN] –ù–µ–≤–æ–∑–º–æ–∂–Ω–æ –¥–æ—Å—Ç–∏—á—å —Å—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –Ω–∞ i={i}")

    # –ù–∞—á–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è Cp –∏ –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∞ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–π
    C_p_ohl[0] = interpolate_C(T_nach, p_ohl[0], name_ohl, T_aray, p_aray, C_aray)
    Cp_1_1 = interpolate_C(T[1], p_ohl[1], name_ohl, T_aray, p_aray, C_aray)
    C_p_raznitsa[0] = abs(Cp_1_1 - C_p_ohl[0]) * 100 / C_p_ohl[0]

    if reverse:
        T = T[::-1]
        C_p_ohl = C_p_ohl[::-1]
        C_p_raznitsa = C_p_raznitsa[::-1]

    return T, C_p_ohl, C_p_raznitsa
def is_inside(points, test_point):
    """
    –ü—Ä–æ–≤–µ—Ä—è–µ—Ç, –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∏—Ç –ª–∏ —Ç–µ—Å—Ç–æ–≤–∞—è —Ç–æ—á–∫–∞ –≤—ã–ø—É–∫–ª–æ–π –æ–±–ª–∞—Å—Ç–∏, –ø–æ—Å—Ç—Ä–æ–µ–Ω–Ω–æ–π –ø–æ –∑–∞–¥–∞–Ω–Ω—ã–º —Ç–æ—á–∫–∞–º —Å –ø–æ–º–æ—â—å—é —Ç—Ä–∏–∞–Ω–≥—É–ª—è—Ü–∏–∏ –î–µ–ª–æ–Ω–µ.

    Args:
        points (array-like): –ú–∞—Å—Å–∏–≤ —Ç–æ—á–µ–∫ (n x d), –≥–¥–µ n ‚Äî –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–æ—á–µ–∫, d ‚Äî —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å (2D –∏–ª–∏ 3D –∏ —Ç.–¥.).
        test_point (array-like): –¢–æ—á–∫–∞, –∫–æ—Ç–æ—Ä—É—é –Ω—É–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å (–≤ —Ç–æ–º –∂–µ —á–∏—Å–ª–µ –∏–∑–º–µ—Ä–µ–Ω–∏–π, —á—Ç–æ –∏ points).

    Returns:
        bool: True, –µ—Å–ª–∏ —Ç–æ—á–∫–∞ –ª–µ–∂–∏—Ç –≤–Ω—É—Ç—Ä–∏ –≤—ã–ø—É–∫–ª–æ–π –æ–±–æ–ª–æ—á–∫–∏ –º–Ω–æ–∂–µ—Å—Ç–≤–∞, –∏–Ω–∞—á–µ False.
    """
    points = np.asarray(points)
    test_point = np.asarray(test_point)
    try:
        tri = Delaunay(points)
        return tri.find_simplex(test_point) >= 0
    except Exception as e:
        raise ValueError(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø—Ä–æ–≤–µ—Ä–∫–µ –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–Ω–æ—Å—Ç–∏ —Ç–æ—á–∫–∏: {e}")
def interpolate_C(T_input, p_input, name_ohl,T_aray, p_aray, C_aray,verbose=False):
    """
    –ò–Ω—Ç–µ—Ä–ø–æ–ª–∏—Ä—É–µ—Ç –∏–ª–∏ —ç–∫—Å—Ç—Ä–∞–ø–æ–ª–∏—Ä—É–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ —Ç–µ–ø–ª–æ—ë–º–∫–æ—Å—Ç–∏ C –ø–æ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–µ –∏ –¥–∞–≤–ª–µ–Ω–∏—é.

    –î–ª—è "—Å–ª–æ–∂–Ω—ã—Ö" –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ (—Å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å—é –æ—Ç –¥–∞–≤–ª–µ–Ω–∏—è) –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è 2D-–∏–Ω—Ç–µ—Ä–ø–æ–ª—è—Ü–∏—è –ø–æ (T, p),
    –≤ –æ—Å—Ç–∞–ª—å–Ω—ã—Ö —Å–ª—É—á–∞—è—Ö ‚Äî –ª–∏–Ω–µ–π–Ω–∞—è 1D-–∏–Ω—Ç–µ—Ä–ø–æ–ª—è—Ü–∏—è –ø–æ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–µ.

    Args:
        T_input (float): –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞, –ö.
        p_input (float): –î–∞–≤–ª–µ–Ω–∏–µ, –ü–∞.
        name_ohl (str): –ù–∞–∑–≤–∞–Ω–∏–µ –æ—Ö–ª–∞–¥–∏—Ç–µ–ª—è.
        T_aray (array-like): –ú–∞—Å—Å–∏–≤ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä.
        p_aray (array-like): –ú–∞—Å—Å–∏–≤ –¥–∞–≤–ª–µ–Ω–∏–π (–¥–ª—è —Å–ª–æ–∂–Ω—ã—Ö –≤–µ—â–µ—Å—Ç–≤).
        C_aray (array-like): –¢–∞–±–ª–∏—Ü–∞ –∑–Ω–∞—á–µ–Ω–∏–π —Ç–µ–ø–ª–æ—ë–º–∫–æ—Å—Ç–∏.
        verbose (bool): –í—ã–≤–æ–¥–∏—Ç—å –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è –ø—Ä–∏ —ç–∫—Å—Ç—Ä–∞–ø–æ–ª—è—Ü–∏–∏.

    Returns:
        float: –ò–Ω—Ç–µ—Ä–ø–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ C.
    """
    complex_components = {"–í–æ–¥–æ—Ä–æ–¥", "–ê–¢", "–ö–∏—Å–ª–æ—Ä–æ–¥", "–ì–µ–ª–∏–π", "–ê–º–º–∏–∞–∫", "–ú–µ—Ç–∞–Ω"}
    if name_ohl in complex_components:
        points = np.column_stack((T_aray, p_aray))
        test_point = np.array([T_input, p_input])

        if is_inside(points, test_point):
            C_interp = griddata(points, C_aray, (T_input, p_input), method='cubic')
            if np.isnan(C_interp):
                C_interp = griddata(points, C_aray, (T_input, p_input), method='linear')
        else:
            if verbose:
                print(f"‚ö†Ô∏è –≠–∫—Å—Ç—Ä–∞–ø–æ–ª—è—Ü–∏—è –ø–æ (T={T_input}, p={p_input}) –¥–ª—è '{name_ohl}'")
            rbf = RBFInterpolator(points, C_aray, kernel='thin_plate_spline')
            C_interp = rbf([[T_input, p_input]])[0]
    else:
        f_interp = interp1d(T_aray, C_aray, kind='linear', fill_value='extrapolate')
        if verbose and (T_input < np.min(T_aray) or T_input > np.max(T_aray)):
            print(f"‚ö†Ô∏è –≠–∫—Å—Ç—Ä–∞–ø–æ–ª—è—Ü–∏—è –ø–æ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–µ T={T_input} –¥–ª—è '{name_ohl}'")
        C_interp = f_interp(T_input)

    return float(C_interp)
def find_temp_st_g(T_og, T_st_g, T_ohl, alpha_ohl, kpd_r, q_kon, q_l,delta_st, lambda_st_vn, d, number, ind_smena, lambda_st_vn_1,verbose=False):
    """
    –†–∞—Å—á—ë—Ç —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã –≥–æ—Ä—è—á–µ–π –∏ —Ö–æ–ª–æ–¥–Ω–æ–π —Å—Ç–µ–Ω–∫–∏ –∫–∞–º–µ—Ä—ã –æ—Ö–ª–∞–∂–¥–µ–Ω–∏—è –ñ–†–î, —Å —É—á—ë—Ç–æ–º —Å–º–µ–Ω—ã –º–∞—Ç–µ—Ä–∏–∞–ª–∞ –≤ –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–æ–π —Ç–æ—á–∫–µ.

    –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –±–∞–ª–∞–Ω—Å —Ç–µ–ø–ª–æ–≤—ã—Ö –ø–æ—Ç–æ–∫–æ–≤ (–∫–æ–Ω–≤–µ–∫—Ü–∏—è, –∏–∑–ª—É—á–µ–Ω–∏–µ) –∏ —Å–æ–ø—Ä–æ—Ç–∏–≤–ª–µ–Ω–∏–µ —Ç–µ–ø–ª–æ–ø—Ä–æ–≤–æ–¥–Ω–æ—Å—Ç–∏.

    Args:
        T_og (float): –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –≥–∞–∑–∞.
        T_st_g (list): –ù–∞—á–∞–ª—å–Ω–∞—è —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –≥–æ—Ä—è—á–µ–π —Å—Ç–µ–Ω–∫–∏ (–ø–æ —Ç–æ—á–∫–∞–º).
        T_ohl (list): –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –æ—Ö–ª–∞–¥–∏—Ç–µ–ª—è.
        alpha_ohl (list): –ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç —Ç–µ–ø–ª–æ–æ—Ç–¥–∞—á–∏ –æ—Ö–ª–∞–¥–∏—Ç–µ–ª—è.
        kpd_r (list): –ö–ü–î —Ç–µ–ø–ª–æ–æ–±–º–µ–Ω–∞.
        q_kon (list): –ö–æ–Ω–≤–µ–∫—Ç–∏–≤–Ω—ã–π —Ç–µ–ø–ª–æ–≤–æ–π –ø–æ—Ç–æ–∫ [–ú–í—Ç/–º¬≤].
        q_l (list): –õ—É—á–∏—Å—Ç—ã–π —Ç–µ–ø–ª–æ–≤–æ–π –ø–æ—Ç–æ–∫ [–ú–í—Ç/–º¬≤].
        delta_st (float): –¢–æ–ª—â–∏–Ω–∞ —Å—Ç–µ–Ω–∫–∏ (–º).
        lambda_st_vn (list): –¢–µ–ø–ª–æ–ø—Ä–æ–≤–æ–¥–Ω–æ—Å—Ç—å –¥–ª—è –º–∞—Ç–µ—Ä–∏–∞–ª–∞ –¥–æ —Ç–æ—á–∫–∏ —Å–º–µ–Ω—ã.
        d (float): –î–∏–∞–º–µ—Ç—Ä –∫–∞–Ω–∞–ª–∞.
        number (list): –ò–Ω–¥–µ–∫—Å—ã —Ä–∞—Å—á—ë—Ç–Ω—ã—Ö —Ç–æ—á–µ–∫.
        ind_smena (int): –ò–Ω–¥–µ–∫—Å, –Ω–∞—á–∏–Ω–∞—è —Å –∫–æ—Ç–æ—Ä–æ–≥–æ –º–∞—Ç–µ—Ä–∏–∞–ª —Å–º–µ–Ω—è–µ—Ç—Å—è.
        lambda_st_vn_1 (list): –¢–µ–ø–ª–æ–ø—Ä–æ–≤–æ–¥–Ω–æ—Å—Ç—å –¥–ª—è –Ω–æ–≤–æ–≥–æ –º–∞—Ç–µ—Ä–∏–∞–ª–∞ –ø–æ—Å–ª–µ `ind_smena`.
        verbose (bool): –ü–µ—á–∞—Ç–∞—Ç—å –∑–Ω–∞—á–µ–Ω–∏—è –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏.

    Returns:
        tuple:
            - T_st_g_itog (list): –†–∞—Å—á—ë—Ç–Ω–∞—è —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –≥–æ—Ä—è—á–µ–π —Å—Ç–µ–Ω–∫–∏.
            - T_st_ohl (list): –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –æ—Ö–ª–∞–¥–∏—Ç–µ–ª—è —É —Å—Ç–µ–Ω–∫–∏.
            - lambda_mat (list): –¢–µ–ø–ª–æ–ø—Ä–æ–≤–æ–¥–Ω–æ—Å—Ç—å –≤ –∫–∞–∂–¥–æ–π —Ç–æ—á–∫–µ.
    """
    T_st_g_itog = []
    T_st_ohl = []
    lambda_mat = []
    k = 0

    # –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ —Ç–µ–ø–ª–æ–ø—Ä–æ–≤–æ–¥–Ω–æ—Å—Ç–∏ (–ø–µ—Ä–µ–Ω–µ—Å—Ç–∏ –≤ constants –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏)
    x_m = np.array([273, 373, 473, 573, 723, 798, 873, 923, 1023, 1073])
    y_m = np.array([220, 240, 260, 280, 300, 310, 315, 310, 300, 292])

    x_s = np.array([373, 423, 473, 523, 573, 623, 673, 723, 773, 823, 873, 923, 973, 1023, 1073, 1123, 1173])
    y_s = np.array([16.5, 16.8, 17.4, 18.1, 19, 19.9, 20.5, 21.6, 22.1, 23, 23.6, 24.1, 25.1, 25.6, 26.6, 27.8, 28.8])

    for t_ohl_i, alpha_i, eta_i, q_k_i, q_l_i, i in zip(
        T_ohl, alpha_ohl, kpd_r, q_kon, q_l, number
    ):
        q_k_i *= 1e6
        q_l_i *= 1e6
        q_total = q_k_i + q_l_i

        lambda_list = lambda_st_vn if i <= ind_smena else lambda_st_vn_1
        lambda_i = lambda_list[i]

        R_cond = delta_st / lambda_i
        R_conv = 1 / (alpha_i * eta_i)
        R_total = R_cond + R_conv

        T_ohl_wall = t_ohl_i
        T_st_g_i = d * (
            T_og / (T_og - T_st_g[i]) +
            T_ohl_wall / (R_total * q_total) +
            q_l_i / q_total
        ) / (
            1 / (T_og - T_st_g[i]) + 1 / (R_total * q_total)
        )

        T_st_g_itog.append(T_st_g_i)

        T_lambda = T_st_g_i
        if i <= ind_smena:
            lambda_val = np.interp(T_lambda, x_m, y_m, left=y_m[0], right=y_m[-1])
        else:
            lambda_val = np.interp(T_lambda, x_s, y_s, left=y_s[0], right=y_s[-1])
        lambda_mat.append(lambda_val)

        T_st_ohl.append(T_st_g_i - (delta_st / lambda_val) * q_total)

        if verbose:
            print(f"[{i}] T_st_g: {T_st_g_i:.2f} K, Œª: {lambda_val:.2f}, T_st_ohl: {T_st_ohl[-1]:.2f} K")

        k += 1

    # –≠–∫—Å–ø–æ—Ä—Ç –≤ Excel (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
    df = pd.DataFrame({'T_st_g_itog': T_st_g_itog, 'T_st_ohl': T_st_ohl})
    df.fillna('-').to_excel('table5.xlsx', index=False)

    return T_st_g_itog, T_st_ohl, lambda_mat, lambda_mat
def find_params_ohl(name_ohl):
    """
    –ó–∞–≥—Ä—É–∂–∞–µ—Ç —Ç–µ–ø–ª–æ—Ñ–∏–∑–∏—á–µ—Å–∫–∏–µ —Å–≤–æ–π—Å—Ç–≤–∞ –æ—Ö–ª–∞–¥–∏—Ç–µ–ª—è –ø–æ –µ–≥–æ –Ω–∞–∑–≤–∞–Ω–∏—é –∏–∑ Excel-—Ñ–∞–π–ª–∞.

    –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ:
    - –°–ª–æ–∂–Ω—ã–µ –æ—Ö–ª–∞–¥–∏—Ç–µ–ª–∏ (–∑–∞–≤–∏—Å—è—Ç –æ—Ç –¥–∞–≤–ª–µ–Ω–∏—è): –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç—Å—è 7 —Å—Ç–æ–ª–±—Ü–æ–≤, –≤–∫–ª—é—á–∞—è `p`.
    - –ü—Ä–æ—Å—Ç—ã–µ –æ—Ö–ª–∞–¥–∏—Ç–µ–ª–∏: 6 —Å—Ç–æ–ª–±—Ü–æ–≤, –±–µ–∑ –¥–∞–≤–ª–µ–Ω–∏—è.

    Args:
        name_ohl (str): –ù–∞–∑–≤–∞–Ω–∏–µ –æ—Ö–ª–∞–¥–∏—Ç–µ–ª—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, "–ê–¢", "–í–æ–¥–æ—Ä–æ–¥", "–ù–î–ú–ì", –∏ —Ç.–¥.)

    Returns:
        tuple:
            - –ï—Å–ª–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç —Å–ª–æ–∂–Ω—ã–π: (T, p, œÅ, C_p, Œº, Œª, K)
            - –ï—Å–ª–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –ø—Ä–æ—Å—Ç–æ–π: (T, œÅ, C_p, Œº, Œª, K)
    """
    file_map = {
        "–í–æ–¥–æ—Ä–æ–¥": ("data/Properties of components/Hydrogen_Features.xlsx", 7),
        "–ê–¢": ("data/Properties of components/Nitrogen-tetraoxide-Features.xlsx", 7),
        "–ö–∏—Å–ª–æ—Ä–æ–¥": ("data/Properties of components/Oxygen-Features.xlsx", 7),
        "–ì–µ–ª–∏–π": ("data/Properties of components/Helium-Features.xlsx", 7),
        "–ê–º–º–∏–∞–∫": ("data/Properties of components/Ammonia-Features.xlsx", 7),
        "–ú–µ—Ç–∞–Ω": ("data/Properties of components/Methane-Features.xlsx", 7),
        "–ù–î–ú–ì": ("data/Properties of components/Hydrazine_Features.xlsx", 6),
        "–ê—ç—Ä–æ–∑–∏–Ω-50": ("data/Properties of components/Aerosin-50-Features.xlsx", 6),
        "–í–æ–¥–∞": ("data/Properties of components/Water_Features.xlsx", 6),
        "–ö–µ—Ä–æ—Å–∏–Ω-–¢1": ("data/Properties of components/Kerosene-T-1-Features.xlsx", 6),
        "–≠—Ç–∞–Ω–æ–ª": ("data/Properties of components/Ethanol-Features.xlsx", 6),
    }

    if name_ohl not in file_map:
        raise ValueError(f"–ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π –æ—Ö–ª–∞–¥–∏—Ç–µ–ª—å: {name_ohl}")

    file_path, num_columns = file_map[name_ohl]

    if not os.path.exists(file_path):
        raise FileNotFoundError(f"–§–∞–π–ª –Ω–µ –Ω–∞–π–¥–µ–Ω: {file_path}")

    workbook = load_workbook(file_path)
    sheet = workbook.active

    columns = [[] for _ in range(num_columns)]
    start_row = 2  # –ø—Ä–æ–ø—É—Å–∫–∞–µ–º –∑–∞–≥–æ–ª–æ–≤–æ–∫

    for col in range(1, num_columns + 1):
        row = start_row
        while True:
            cell_value = sheet.cell(row=row, column=col).value
            if cell_value is None:
                break
            columns[col - 1].append(cell_value)
            row += 1

    # –†–∞—Å–ø–∞–∫–æ–≤–∫–∞
    if num_columns == 7:
        T, p, rho, Cp, mu, lamb, K = columns
        return T, p, rho, Cp, mu, lamb, K
    else:
        T, rho, Cp, mu, lamb, K = columns
        return T, rho, Cp, mu, lamb, K
def find_nearest_index(array, value):
    """
    –ù–∞—Ö–æ–¥–∏—Ç –∏–Ω–¥–µ–∫—Å –±–ª–∏–∂–∞–π—à–µ–≥–æ –ø–æ –∑–Ω–∞—á–µ–Ω–∏—é —ç–ª–µ–º–µ–Ω—Ç–∞ –≤ –º–∞—Å—Å–∏–≤–µ –∫ –∑–∞–¥–∞–Ω–Ω–æ–º—É —á–∏—Å–ª—É.

    Args:
        array (list of float): –°–ø–∏—Å–æ–∫ —á–∏—Å–µ–ª, —Å—Ä–µ–¥–∏ –∫–æ—Ç–æ—Ä—ã—Ö –≤–µ–¥—ë—Ç—Å—è –ø–æ–∏—Å–∫.
        value (float): –ó–Ω–∞—á–µ–Ω–∏–µ, –∫ –∫–æ—Ç–æ—Ä–æ–º—É –∏—â–µ—Ç—Å—è –±–ª–∏–∂–∞–π—à–µ–µ.

    Returns:
        int: –ò–Ω–¥–µ–∫—Å –±–ª–∏–∂–∞–π—à–µ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞.

    Raises:
        ValueError: –ï—Å–ª–∏ –ø–µ—Ä–µ–¥–∞–Ω –ø—É—Å—Ç–æ–π –º–∞—Å—Å–∏–≤.
    """
    if not array:
        raise ValueError("–ú–∞—Å—Å–∏–≤ –ø—É—Å—Ç–æ–π ‚Äî –Ω–µ–ª—å–∑—è –Ω–∞–π—Ç–∏ –±–ª–∏–∂–∞–π—à–∏–π —ç–ª–µ–º–µ–Ω—Ç.")
    return min(range(len(array)), key=lambda i: abs(array[i] - value))
def reflect_tail(x, y, n):
    """
    –ó–µ—Ä–∫–∞–ª—å–Ω–æ –æ—Ç—Ä–∞–∂–∞–µ—Ç –ø–æ—Å–ª–µ–¥–Ω–∏–µ `n` —Ç–æ—á–µ–∫ –º–∞—Å—Å–∏–≤–∞ `x, y` –∏ –¥–æ–±–∞–≤–ª—è–µ—Ç –æ—Ç—Ä–∞–∂—ë–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –≤ –∫–æ–Ω–µ—Ü.

    –û—Ç—Ä–∞–∂–µ–Ω–∏–µ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –ø–æ—Å–ª–µ–¥–Ω–µ–π —Ç–æ—á–∫–∏ —Ö–≤–æ—Å—Ç–∞ –ø–æ –æ—Å–∏ X,
    —Å–æ–∑–¥–∞–≤–∞—è —Å–∏–º–º–µ—Ç—Ä–∏—á–Ω–æ–µ –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ –≥—Ä–∞—Ñ–∏–∫–∞.

    Args:
        x (list of float): –ò—Å—Ö–æ–¥–Ω—ã–π –º–∞—Å—Å–∏–≤ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç –ø–æ X.
        y (list of float): –ò—Å—Ö–æ–¥–Ω—ã–π –º–∞—Å—Å–∏–≤ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç –ø–æ Y.
        n (int): –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–æ—á–µ–∫ –¥–ª—è –æ—Ç—Ä–∞–∂–µ–Ω–∏—è (—Å –∫–æ–Ω—Ü–∞).

    Returns:
        tuple:
            - x_new (list of float): –†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–π –º–∞—Å—Å–∏–≤ X —Å –æ—Ç—Ä–∞–∂—ë–Ω–Ω–æ–π —á–∞—Å—Ç—å—é.
            - y_new (list of float): –†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–π –º–∞—Å—Å–∏–≤ Y —Å –æ—Ç—Ä–∞–∂—ë–Ω–Ω–æ–π —á–∞—Å—Ç—å—é.

    Raises:
        ValueError: –ï—Å–ª–∏ n –±–æ–ª—å—à–µ –¥–ª–∏–Ω—ã –≤—Ö–æ–¥–Ω—ã—Ö –º–∞—Å—Å–∏–≤–æ–≤.
    """
    if n > len(x) or n > len(y):
        raise ValueError("–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–æ—á–µ–∫ –¥–ª—è –æ—Ç—Ä–∞–∂–µ–Ω–∏—è –ø—Ä–µ–≤—ã—à–∞–µ—Ç –¥–ª–∏–Ω—É –º–∞—Å—Å–∏–≤–∞.")

    x_tail = x[-n:]
    y_tail = y[-n:]

    x_mirror = x_tail[-1]
    x_reflected = [2 * x_mirror - xi for xi in reversed(x_tail)]
    y_reflected = list(reversed(y_tail))

    x_new = x + x_reflected
    y_new = y + y_reflected

    return x_new, y_new
def clone_temp_st(array_1, array_2, n, X=None):
    """
    –°–æ–∑–¥–∞—ë—Ç —Å–≥–ª–∞–∂–µ–Ω–Ω—ã–π —Å–∏–º–º–µ—Ç—Ä–∏—á–Ω—ã–π —Ö–≤–æ—Å—Ç –≤ –º–∞—Å—Å–∏–≤–∞—Ö —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã (–≥–æ—Ä—è—á–µ–π –∏ —Ö–æ–ª–æ–¥–Ω–æ–π —Å—Ç–µ–Ω–∫–∏),
    —É—Å—Ä–µ–¥–Ω—è—è –∑–µ—Ä–∫–∞–ª—å–Ω—ã–µ —Ç–æ—á–∫–∏ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ —Ü–µ–Ω—Ç—Ä–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —É—á–∞—Å—Ç–∫–∞.

    –ê–ª–≥–æ—Ä–∏—Ç–º:
    - –î–µ–ª–∏—Ç –ø–æ—Å–ª–µ–¥–Ω–∏–µ `n` —Ç–æ—á–µ–∫ –Ω–∞ –¥–≤–µ –ø–æ–ª–æ–≤–∏–Ω—ã.
    - –£—Å—Ä–µ–¥–Ω—è–µ—Ç –ø–æ–ø–∞—Ä–Ω–æ —Å–∏–º–º–µ—Ç—Ä–∏—á–Ω—ã–µ —Ç–æ—á–∫–∏.
    - –°–∫–ª–µ–∏–≤–∞–µ—Ç —Å –æ—Å–Ω–æ–≤–Ω–æ–π —á–∞—Å—Ç—å—é –º–∞—Å—Å–∏–≤–∞.

    Args:
        array_1 (list of float): –ü–µ—Ä–≤—ã–π —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–Ω—ã–π –ø—Ä–æ—Ñ–∏–ª—å (–Ω–∞–ø—Ä–∏–º–µ—Ä, T_st_g).
        array_2 (list of float): –í—Ç–æ—Ä–æ–π –ø—Ä–æ—Ñ–∏–ª—å (–Ω–∞–ø—Ä–∏–º–µ—Ä, T_st_ohl).
        n (int): –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–æ—á–µ–∫ –≤ —Ö–≤–æ—Å—Ç–µ, –∫–æ—Ç–æ—Ä—ã–µ –ø–æ–¥–ª–µ–∂–∞—Ç –∑–µ—Ä–∫–∞–ª—å–Ω–æ–º—É —É—Å—Ä–µ–¥–Ω–µ–Ω–∏—é (n –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å —á—ë—Ç–Ω—ã–º).
        X (list, optional): –ù–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è (–º–æ–∂–Ω–æ —É–¥–∞–ª–∏—Ç—å –∏–ª–∏ –¥–æ–±–∞–≤–∏—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ).

    Returns:
        tuple:
            - array_1_smoothed (list of float): –û–±–Ω–æ–≤–ª—ë–Ω–Ω—ã–π –ø—Ä–æ—Ñ–∏–ª—å —Å —Å–∏–º–º–µ—Ç—Ä–∏—á–Ω—ã–º —Ö–≤–æ—Å—Ç–æ–º.
            - array_2_smoothed (list of float): –ê–Ω–∞–ª–æ–≥–∏—á–Ω–æ, –¥–ª—è –≤—Ç–æ—Ä–æ–≥–æ –º–∞—Å—Å–∏–≤–∞.
    """
    def smooth_symmetric_tail(arr, n):
        start = arr[:len(arr) - n]
        tail = arr[-n:]
        mid = n // 2
        left = tail[:mid]
        right = tail[mid:][::-1]
        smoothed = [(a + b) * 0.5 for a, b in zip(left, right)]
        symmetric_tail = smoothed + smoothed[::-1]
        return start + symmetric_tail

    if n % 2 != 0:
        raise ValueError("n –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å —á—ë—Ç–Ω—ã–º –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–≥–æ –∑–µ—Ä–∫–∞–ª—å–Ω–æ–≥–æ —É—Å—Ä–µ–¥–Ω–µ–Ω–∏—è.")
    if len(array_1) < n or len(array_2) < n:
        raise ValueError("–î–ª–∏–Ω–∞ –º–∞—Å—Å–∏–≤–æ–≤ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –±–æ–ª—å—à–µ n.")

    array_1_smoothed = smooth_symmetric_tail(array_1, n)
    array_2_smoothed = smooth_symmetric_tail(array_2, n)

    return array_1_smoothed, array_2_smoothed